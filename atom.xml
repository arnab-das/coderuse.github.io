<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CodeRuse</title>
  <subtitle>Re-usable code to encounter daily Ruses</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://coderuse.com/"/>
  <updated>2020-02-23T16:26:38.956Z</updated>
  <id>http://coderuse.com/</id>
  
  <author>
    <name>Arnab Das</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Adoption Of Microservices For RPA</title>
    <link href="http://coderuse.com/2020/02/Adoption-Of-Microservices-For-RPA/"/>
    <id>http://coderuse.com/2020/02/Adoption-Of-Microservices-For-RPA/</id>
    <published>2020-02-23T06:23:45.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;The global robotic process automation market size was valued at USD 1.1 billion in 2019 and is anticipated to witness a CAGR of 33.6% from 2020 to 2027.&lt;br&gt;&lt;a href=&quot;https://www.grandviewresearch.com/industry-analysis/robotic-process-automation-rpa-market&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Grand View Research&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Global spends on RPA programs are being projected to rise to 2.4 billion USD by 2022.&lt;br&gt;&lt;a href=&quot;https://www.gartner.com/en/newsroom/press-releases/2018-11-13-gartner-says-worldwide-spending-on-robotic-process-automation-software-to-reach-680-million-in-2018&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Gartner Report&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;No doubt Robotic Process Automation is taking the front seat for the majority investments of the enterprises in the coming years. From &lt;a href=&quot;https://www2.deloitte.com/us/en/pages/operations/articles/global-robotic-process-automation-report.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Deloitte’s third Annual Global RPA Survey Report&lt;/a&gt;, 35 percent of more than four hundred executives responsible for running transactional operations such as global business services, shared services, finance, procurement, HR, marketing, and operations agreed to “Focus on continuous improvement”, 24 percent to “Increase level of automation” and 17 percent to “Develop analytics capabilities”. Given the high impact of RPA on these top-three priorities, continued investment in its adoption is not surprising.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Organizations are seeking to embrace RPA solutions swiftly while aspiring to realize productivity gains with minimal CaPex (capital expenditure). However, good intentions and promising technologies alone cannot yield the desired results. Organizations are facing teething issues while scaling their RPA implementations from individual business process automation to enterprise-grade RPA. These challenges are classified into three themes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bot instability&lt;/li&gt;
&lt;li&gt;low bot velocity&lt;/li&gt;
&lt;li&gt;code base complexity issues&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Excerpts from &lt;a href=&quot;https://medium.com/@sharad_shukla/leveraging-microservices-design-methodology-for-streamlined-bot-development-9d40d96e410f&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sharad Shukla’s Blog&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Most popular and used solutions for RPA, like UIPath, Blue Prism starts like POCs / experiments by the executives or business users in organisations and later come out to be hard to maintain, support and develop complex business workflows. Even with the concepts like &lt;a href=&quot;https://www.linkedin.com/pulse/microbots-architecture-rpa-robson-fernando-veiga/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Microbots Architechture for RPA&lt;/a&gt;, popular solutions fails to meet sweet spot of price vs performance ratio with the growing business needs.&lt;/p&gt;
&lt;p&gt;Now let’s calculate approximate running cost for using popular RPA solution provider like UIPath. As the pricing has not been clearly mentioned on their website. Following pricing information has bee taken from one of popular &lt;a href=&quot;https://www.edureka.co/community/58057/pricing-scheme-uipath-uipath-studio-orchestrator-licence&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;learning platform’s forum thread&lt;/a&gt;. Also we will try to understand why there has been some &lt;a href=&quot;https://ui.vision/blog/uipath-pricing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;concerns over this&lt;/a&gt;. Not just UIPath, also compare the cost of developing, deploying, maintaining Blue Prism solutions from this &lt;a href=&quot;https://www.itcentralstation.com/product_reviews/blue-prism-review-62487-by-sharad-soni&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;detailed post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here we are going to examine the approach to design, develop, deployment and maintainance for a very simple requirement posed in one of the &lt;a href=&quot;https://forum.uipath.com/t/build-scalable-solution/19923&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;support tickets&lt;/a&gt; of UIPath.&lt;/p&gt;
&lt;p&gt;Let’s try to chalk out the requirements. The customer stated in the final post of the thread that he is very happy with 4 un-attended bots, governed by one orchestrator (included in the initial diagram) with UIPath Studio running on the same Windows server with 16GB of RAM (as was the discussion in the earlier posts in the same thread). &lt;/p&gt;
&lt;p&gt;With the pricing model of UIPath, &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;licenses for four bots costs around $8000 x 4 = $32000/year&lt;/li&gt;
&lt;li&gt;orchestrator around $20000/year&lt;/li&gt;
&lt;li&gt;the Studio around $2000/year at the minimum price&lt;/li&gt;
&lt;li&gt;the Windows Server 2016 (assuming as the customer had one bot previously on the server) comes at around $770 per two cores, plus maintaintenance $5000 per year at minimum.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, in total almost &lt;em&gt;$62000 per year&lt;/em&gt; to process emails from customers and creating various tasks to be performed based on the inputs in the mail. &lt;/p&gt;
&lt;p&gt;May be the bots here are responding the customers with some canned response also, &lt;em&gt;without knowing the sentiment of the customers&lt;/em&gt;. Here I’ve excluded the development cost for the workflows to be run on the bots. But surely we will come back to it later. And being completely driven by the UI, it’s not hard to imagine that preparing a proper and correct workflow, it would require jugglery of loops and if-else conditions, tricky manipulation of available limited options and of-course lot of frustrating to-n-fro conversations with customer supports.&lt;/p&gt;
&lt;p&gt;Now, come to the solution with custom made micro-apps using AI services from cloud providers like Azure, AWS, Google.&lt;/p&gt;
&lt;p&gt;Ofcourse I’m slightly biased towards Microsoft Platform, as I’ve been working for a long time with C# and Microsoft Azure. Microsoft also &lt;a href=&quot;https://www.zdnet.com/article/microsoft-says-it-has-come-a-long-way-since-that-open-source-comment/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;have come a long way&lt;/a&gt; since the days of being closed with a proprietary operating system like Windows XP. Now we can develop, build and deploy with &lt;a href=&quot;https://docs.microsoft.com/en-us/archive/msdn-magazine/2016/april/net-core-net-goes-cross-platform-with-net-core&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;.Net Core on cross platform&lt;/a&gt;, means same program can run on Windows, Linux and Mac, all major OS platforms. And .Net Core’s performance on Linux is &lt;a href=&quot;https://benchmarksgame-team.pages.debian.net/benchmarksgame/fastest/csharp.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;quite impressive&lt;/a&gt;(sometimes it’s even better than C++). And Azure though started late, emerged with feature rich offerrings, more availability zones and of-course lower priced services among three. And among the top three runners showing &lt;a href=&quot;https://intellipaat.com/blog/aws-vs-azure-vs-google-cloud/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;most growth rate&lt;/a&gt; and &lt;a href=&quot;https://www.datamation.com/cloud-computing/aws-vs-azure-vs-google-cloud-comparison.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;second in customer preference&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let’s figure out the solution we would need to cater the requirement of the customer.&lt;/p&gt;
&lt;p&gt;First we need a service to read the mails. There are plenty of examples &lt;a href=&quot;https://www.c-sharpcorner.com/UploadFile/jj12345678910/reading-email-and-attachment-from-microsoft-exchange-server/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;like this&lt;/a&gt; to read mails from exchange servers. By using these we would be able to develop a decent program to read incoming mails from a particular inbox. This mail reader application would just queue the mails into a &lt;em&gt;Email Processing Queue&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Specifics of the tasks created/executed by the UIPath robot is not very clear from the thread. But in the flow diagram given by the customer, may be along with responding customer with a mail, it’s creating Excel reports and feeding data to some databases.&lt;/p&gt;
&lt;p&gt;For our solution let’s make the email processing a bit more complex. Suppose along with customer support requests, we are also getting invoices from the vendors. So, our mail-receiver application has to first sort through the received mails like a post office. This sorting can be done first by checking the mail address the mail has been sent to. But there may be some emails sent by the customers to wrong email address. So the application also has to understand the intent of the email to sort correctly. To understand this “Intent” / “Emotion” we can use &lt;a href=&quot;https://azure.microsoft.com/en-in/services/cognitive-services/text-analytics/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Azure Text Analytics Service&lt;/a&gt;. It can send sentiment and classification of the words written in a piece of text.&lt;/p&gt;
&lt;p&gt;Also the invoice mails may contain scanned images of physical bills, challans etc. We have to persist relevant data into the invoice database to create reports. For this we can use &lt;a href=&quot;https://azure.microsoft.com/en-in/services/cognitive-services/computer-vision/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Azure Computer Vision&lt;/a&gt;. This service can respond back with the texts available in the image. Once we get the information we can persist the info in the invoice database.&lt;/p&gt;
&lt;p&gt;From the customer support mail after understanding the intent or the request itself, the application itself can create tasks / orders to work with or process the invoices from vendors.&lt;/p&gt;
&lt;p&gt;In total we need 6 micro-services.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Email Reader Micro-Service&lt;/strong&gt;: This would just read the incoming mails and put them into a processing queue&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Email Queue Processing Micro-Service&lt;/strong&gt;: This would sort through the mails and put into department specific queue. While sorting this would call Text Analytics Service, get response, looks for specific words to analyse to put the mail into correct departments’ queue. It also attaches the response with the email while putting into the department queues for future references.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Accounts Queue Processing Micro-Service&lt;/strong&gt;: This would get the mail, download all the attachments if there be any. Send the images to Azure OCR API, get relevant information, persist the relevant information into the DB, revert back with one email to the vendor for some more supporting documents including the status of the raised invoice.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Customer Support Processing Micro-Service&lt;/strong&gt;: From the intent of the mail received from the Azure Text Service, create proper order / task for the internal team to work with, or if possible send a mail to the customer containing some relevant troubleshooting information.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Customer Relations Micro-Service&lt;/strong&gt;: For this we are planning for a very simple workflow. It would only send emails on customer’s birthdays / anniversaries. Also it can take responsibilities to send pacifier mails / offers to customers with long standing issues.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Email Sender Micro-Service&lt;/strong&gt;: This is a very simple application which can only send emails.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now let’s understand the deployment and interactions among these with the following diagram.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/Xj1MdwQ.jpg&quot; alt=&quot;RPA with Microservices&quot;&gt;&lt;/p&gt;
&lt;p&gt;All these six microservices can be easily deployed on a five node Kubernetes Cluster on Azure with 2 cores and 16 GB of RAM running Linux OS (Azure deploys with Ubuntu). On East US 2 region the said configuration comes at around $110/month each node. So, running cost of the whole solution comes at around $550/month, accumulating $6600/year. No license cost or other hidden costs. And this cluster would be much more powerful than the server with 16 GB RAM running 4 bots, orchestrator and studio.&lt;/p&gt;
&lt;p&gt;Let’s talk about pros and cons of two approaches.&lt;/p&gt;
&lt;h3 id=&quot;Popular-RPA-solutions-like-UIPath-Blue-Prism&quot;&gt;&lt;a href=&quot;#Popular-RPA-solutions-like-UIPath-Blue-Prism&quot; class=&quot;headerlink&quot; title=&quot;Popular RPA solutions like UIPath, Blue Prism&quot;&gt;&lt;/a&gt;Popular RPA solutions like UIPath, Blue Prism&lt;/h3&gt;&lt;h4 id=&quot;Pros&quot;&gt;&lt;a href=&quot;#Pros&quot; class=&quot;headerlink&quot; title=&quot;Pros&quot;&gt;&lt;/a&gt;Pros&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Easy to start with&lt;/li&gt;
&lt;li&gt;Requires low skill developers to develop and maintain&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Cons&quot;&gt;&lt;a href=&quot;#Cons&quot; class=&quot;headerlink&quot; title=&quot;Cons&quot;&gt;&lt;/a&gt;Cons&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Running (mainly license) cost is quite large &lt;/li&gt;
&lt;li&gt;Reusability of bot code is almost zero, making support also quite expensive&lt;/li&gt;
&lt;li&gt;Low bot speed&lt;/li&gt;
&lt;li&gt;Bot instability&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;RPA-With-MicroServices&quot;&gt;&lt;a href=&quot;#RPA-With-MicroServices&quot; class=&quot;headerlink&quot; title=&quot;RPA With MicroServices&quot;&gt;&lt;/a&gt;RPA With MicroServices&lt;/h4&gt;&lt;h3 id=&quot;Pros-1&quot;&gt;&lt;a href=&quot;#Pros-1&quot; class=&quot;headerlink&quot; title=&quot;Pros&quot;&gt;&lt;/a&gt;Pros&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Low OPEX&lt;/li&gt;
&lt;li&gt;Being microservice, extremely extensible&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Cons-1&quot;&gt;&lt;a href=&quot;#Cons-1&quot; class=&quot;headerlink&quot; title=&quot;Cons&quot;&gt;&lt;/a&gt;Cons&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Needs better planning, design and more skilled developers. But that compensates with the ongoing OPEX of the solution within two to three years.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To conclude, ofcourse starting RPA with MicroServices has cost. But compare it with the maintenance and running cost. And if RPA needs complex workflow with lot of touchpoints, like cloud sevices from Salesforce, Oracle or needs integrations with AI services or needs real time processing (this can be done with CEP on Spark clusters), it’s always better to opt for MicroServices.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;The global robotic process automation market size was valued at USD 1.1 billion in 2019 and is anticipated to witness a CAGR
    
    </summary>
    
      <category term="MicroService" scheme="http://coderuse.com/categories/MicroService/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/MicroService/Technical/"/>
    
    
      <category term="microservices" scheme="http://coderuse.com/tags/microservices/"/>
    
      <category term="rpa" scheme="http://coderuse.com/tags/rpa/"/>
    
  </entry>
  
  <entry>
    <title>OIDC - Acquiring Access Token By Implicit Flow From Azure Active Directory</title>
    <link href="http://coderuse.com/2018/10/OIDC-Acquiring-Token-Implicit-Flow-Azure-Active-Directory/"/>
    <id>http://coderuse.com/2018/10/OIDC-Acquiring-Token-Implicit-Flow-Azure-Active-Directory/</id>
    <published>2018-10-11T06:23:45.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://openid.net/connect/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;OpenID Connect&lt;/a&gt;, outlined by &lt;a href=&quot;https://tools.ietf.org/html/rfc6749&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RFC-6749&lt;/a&gt;, allows web based clients to authenticate end users with identity providers and acquire access-token to be used to access web resources, API’s, protected by &lt;a href=&quot;https://en.wikipedia.org/wiki/OAuth#OAuth_2.0&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;OAuth 2.0&lt;/a&gt; compatible frameworks.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-whatis&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Azure Active Directory&lt;/a&gt; is a identity management service offered by Microsoft hosted on &lt;a href=&quot;https://azure.microsoft.com/en-us/services/active-directory/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Azure&lt;/a&gt; cloud platform. It offers management of user, group and roles within cloud instance of Active Directory. AAD supports all the handshakes outlined by RFC-6749. With a &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vast library of documents&lt;/a&gt; from Microsoft, it’s easy to go through the how-tos and quickly spin up a web app authenticating with AAD. But within the tutorials they mostly use complex libraries like &lt;a href=&quot;https://github.com/AzureAD/azure-activedirectory-library-for-js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ADAL.Js&lt;/a&gt; or &lt;a href=&quot;https://github.com/AzureAD/microsoft-authentication-library-for-js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MSAL.Js&lt;/a&gt; for client side authentication with AAD. The libraries are no-doubt very convenient to use and have lot of features. But libraries hides the inner management of urls and the parameters are requested with.&lt;/p&gt;
&lt;p&gt;In this post we are going to examine the &lt;a href=&quot;https://tools.ietf.org/html/rfc6749#section-4.2&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;implicit grant&lt;/a&gt; of OIDC with &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AAD&lt;/a&gt; by creating a very simple web app. The source of the web app is available on &lt;a href=&quot;https://github.com/coderuse/aad-implicit-flow&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt; and hosted at &lt;a href=&quot;https://coderuse.github.io/aad-implicit-flow/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;coderuse.github.io/aad-implicit-flow&lt;/a&gt;. Here we are not exploring the implicit flow in whole, rather trying to understand the redirections happens during the auhtentication. I would recommend to go through the links provided here for starter to understand better.&lt;/p&gt;
&lt;p&gt;When we are working with browser for OAuth-2.0 authentication, it needs to be understood that urls that are being redirected to and from are very important. All the parameters are needed to be passed via urls and the responses are also needed to be parsed from urls. For this we need some &lt;a href=&quot;https://github.com/coderuse/aad-implicit-flow/blob/master/app.js#L4-L29&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;utility methods&lt;/a&gt; to parse urls for response. These methods are taken from ADAL.Js.&lt;/p&gt;
&lt;p&gt;The process starts with checking whether the access token is present in the url or not. For that we are using the following method.&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isSignInProgress&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; result = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; hash = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.location.hash;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (hash) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        hash = getHash(hash);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; parameters = deserialize(hash);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parameters) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parameters.hasOwnProperty(&lt;span class=&quot;string&quot;&gt;&#39;error_description&#39;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; errorDescription = parameters[&lt;span class=&quot;string&quot;&gt;&#39;error_description&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    error: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        description: errorDescription&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (parameters.hasOwnProperty(&lt;span class=&quot;string&quot;&gt;&#39;access_token&#39;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; parameters[&lt;span class=&quot;string&quot;&gt;&#39;access_token&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;We invoke the above method from a time elapsed method by &lt;code&gt;setTimeout&lt;/code&gt; like the following.&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; intrvl = setInterval(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; accessToken = isSignInProgress();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (accessToken) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        clearInterval(intrvl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (accessToken.error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(accessToken.error.description);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;id-access-token&#39;&lt;/span&gt;).value = accessToken;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(accessToken);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// else &amp;#123; redirect to the provider to acquire token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// loginRedirect(tenant, clientId, scope);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;, &lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Need for this timeout is to prevent auto-redirection. To take the input from user, the need to auto redirect the login page to authentication provider does not arise here. But in actual application, the required information are already present. So, no need to wait for login initiation by user, like we are doing in the demo app. Typically the page should be redirected from the else block of the above method.&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;loginRedirect&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;tenant, clientId, scope&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; loginUri = &lt;span class=&quot;string&quot;&gt;&#39;https://login.microsoftonline.com/&#39;&lt;/span&gt; + tenant + &lt;span class=&quot;string&quot;&gt;&#39;/oauth2/v2.0/authorize?&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; params = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;client_id=&#39;&lt;/span&gt; + clientId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;response_type=id_token token&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;redirect_uri=https://coderuse.github.io/aad-implicit-flow/&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;scope=openid &#39;&lt;/span&gt; + scope);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;response_mode=fragment&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;state=12345&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    params.push(&lt;span class=&quot;string&quot;&gt;&#39;nonce=678910&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    loginUri += &lt;span class=&quot;built_in&quot;&gt;decodeURIComponent&lt;/span&gt;(params.join(&lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.location.replace(loginUri);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Here we are using &lt;code&gt;id_token token&lt;/code&gt; to get the access token in a single redirection. The recommended way of doing this is to first acquire the &lt;code&gt;id_token&lt;/code&gt; and then acquire the &lt;code&gt;access_token&lt;/code&gt; silently(without any further user inputs) via an iframe. But in reality, the second part, creating iframe and all does not work due to the restrictions posed by the modern browsers. And iframes should be discarded by all means in production deployments. And it’s really difficult to work with iframes on &lt;a href=&quot;https://cordova.apache.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cordova&lt;/a&gt;. So, a second redirection or creating a popup window with proper url containing the &lt;code&gt;id_token&lt;/code&gt; is required to be invoked to get the access token.&lt;/p&gt;
&lt;p&gt;Though &lt;code&gt;implicit flow&lt;/code&gt; is recommended for browser app. In my opinion &lt;a href=&quot;https://tools.ietf.org/html/rfc6749#section-4.1&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;auth code flow&lt;/a&gt; is more appropriate than the prior one. We will have one more post with &lt;code&gt;auth code flow&lt;/code&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://openid.net/connect/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;OpenID Connect&lt;/a&gt;, outlined by &lt;a href=&quot;https://tools.ietf.org/html
    
    </summary>
    
      <category term="PAAS" scheme="http://coderuse.com/categories/PAAS/"/>
    
      <category term="IDAS" scheme="http://coderuse.com/categories/PAAS/IDAS/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/PAAS/IDAS/Technical/"/>
    
    
      <category term="active-active-directory" scheme="http://coderuse.com/tags/active-active-directory/"/>
    
      <category term="oidc" scheme="http://coderuse.com/tags/oidc/"/>
    
      <category term="openid-connect" scheme="http://coderuse.com/tags/openid-connect/"/>
    
  </entry>
  
  <entry>
    <title>Stop logging in Ubuntu</title>
    <link href="http://coderuse.com/2018/07/Stop-Logging-In-Ubuntu/"/>
    <id>http://coderuse.com/2018/07/Stop-Logging-In-Ubuntu/</id>
    <published>2018-07-07T06:23:45.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Now-a-days cheap VPS’s are very much available. Usually these cheap VPS’s provides very low resources. Minimum reasonable disk space, very low CPU share, 32 to 128 MB RAM. Main problem with low resources is that these fills up very quickly with logs. It would be very beneficial for these systems if the logs may be stopped or at-least minimized. And the logging also takes quite a bit CPU percentage.&lt;/p&gt;
&lt;p&gt;By default Linux systems log very extensively for all the services running. In general we should not stop the logging service altogether. Though it’s possible by invoking the command &lt;code&gt;service rsyslog stop&lt;/code&gt; [in this article we are mostly discussing about Ubuntu]. Lot of services may depend on this, as this is one of the core services of the OS.&lt;/p&gt;
&lt;p&gt;But we can stop this logging altogether, keeping the &lt;code&gt;rsyslog&lt;/code&gt; service running. Open the file &lt;code&gt;/etc/rsyslog.conf&lt;/code&gt; and comment the line &lt;code&gt;$IncludeConfig /etc/rsyslog.d/*.conf&lt;/code&gt;. Restart the service by &lt;code&gt;service rsyslog restart&lt;/code&gt; or &lt;code&gt;systemctl restart rsyslog&lt;/code&gt;. Check the status whether it’s running &lt;code&gt;service rsyslog status&lt;/code&gt;. &lt;code&gt;journal&lt;/code&gt; may show complain from &lt;code&gt;rsyslog&lt;/code&gt; that, it has not found any viable configurations to log. That’s okay.&lt;/p&gt;
&lt;p&gt;Another service for logging and therefore responsible for filling disk is &lt;code&gt;journalctl&lt;/code&gt;. For this look for the services that are running. For &lt;code&gt;systemd&lt;/code&gt; the services resides, if not otherwised customised in &lt;code&gt;/etc/systemd/system&lt;/code&gt;. We can check those files if they contains any command for potential logging. In my case I run &lt;code&gt;Shadowsocks&lt;/code&gt; to create secure proxy. I’ve configured this with the help of the documents from &lt;a href=&quot;https://www.linode.com/docs/networking/vpn/create-a-socks5-proxy-server-with-shadowsocks-on-ubuntu-and-centos7/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;linode&lt;/a&gt;. But in the script for running &lt;code&gt;Shadowsocks&lt;/code&gt; as service, they have started and stopped the service with &lt;code&gt;-v&lt;/code&gt; flag. With this flag, &lt;code&gt;Shadowsocks&lt;/code&gt; logs each and every connections, that are being made through it. It kind of objects the purpose of using &lt;code&gt;Shadowsocks&lt;/code&gt;. Moreover increases the log. Anyways it’s better to have it without the &lt;code&gt;verbose&lt;/code&gt; flag.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ExecStart=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/ss-server -c /etc/shadowsocks/shadowsocks.json &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; shadowsocks -v start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ExecStop=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/ss-server -c /etc/shadowsocks/shadowsocks.json &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; shadowsocks -v stop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Also it would be best if nothing comes out of &lt;code&gt;start&lt;/code&gt; and &lt;code&gt;stop&lt;/code&gt;. So let’s dump all to &lt;code&gt;/dev/null&lt;/code&gt;. So the commands would be,&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ExecStart=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/ss-server -c /etc/shadowsocks/shadowsocks.json &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; shadowsocks start &amp;gt; /dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ExecStop=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/ss-server -c /etc/shadowsocks/shadowsocks.json &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; shadowsocks stop &amp;gt; /dev/null&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To minimize the logs from &lt;code&gt;journalctl&lt;/code&gt;, it’s very helpful to run a &lt;code&gt;cron&lt;/code&gt; daily with the following script.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;shebang&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/bin/journalctl --vacuum-time=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# it&#39;s possible to ommit the following line, if one log is manageable for the system disk spce&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/bin/journalctl --vacuum-size=&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;M&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Save the file in the &lt;code&gt;home&lt;/code&gt; directory, add execution permission by &lt;code&gt;chmod +x clear_logs.sh&lt;/code&gt; and set the &lt;code&gt;cron&lt;/code&gt; with &lt;code&gt;crontab -e&lt;/code&gt;. And add one line like &lt;code&gt;0 22 * * * /root/cron_Jobs/clearlogs.sh&lt;/code&gt;. It would run the file once at 10PM.&lt;/p&gt;
&lt;p&gt;Another source of logs are from web servers. For Nginx we can stop the logging by adding the following lines to the server block.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;access_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; off;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;error_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; off;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;By convention the services stores the log files inside the directory &lt;code&gt;/var/log&lt;/code&gt;. Sometimes it’s helpful to check the sizes of the directories inside this. To have consolidated size of a directory use &lt;code&gt;du -sh &amp;lt;directory_name&amp;gt;&lt;/code&gt;. To see the running log for a file, suppose &lt;code&gt;/var/log/syslog&lt;/code&gt; use &lt;code&gt;tail -f /var/log/syslog&lt;/code&gt;. And to see the available disk space of the system &lt;code&gt;df -h&lt;/code&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Now-a-days cheap VPS’s are very much available. Usually these cheap VPS’s provides very low resources. Minimum reasonable disk space, ver
    
    </summary>
    
      <category term="System" scheme="http://coderuse.com/categories/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/System/Technical/"/>
    
    
      <category term="logging" scheme="http://coderuse.com/tags/logging/"/>
    
      <category term="ubuntu" scheme="http://coderuse.com/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript String Concatenations A Few Gotchas</title>
    <link href="http://coderuse.com/2017/10/JavaScript-String-Concatenations-A-Few-Gotchas/"/>
    <id>http://coderuse.com/2017/10/JavaScript-String-Concatenations-A-Few-Gotchas/</id>
    <published>2017-10-29T18:52:54.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;We use string concatenations in JavaScript frequently. But if we look closely, it may raise a few new confusions. So, let’s begin.&lt;/p&gt;
&lt;p&gt;What will be the output of &lt;code&gt;&amp;#39;a&amp;#39; + + &amp;#39;b&amp;#39;&lt;/code&gt;. &lt;code&gt;aNaN&lt;/code&gt;. It’s understandable, that something unexpected should come, as we’ve mis-typed an extra &lt;code&gt;+&lt;/code&gt;, but what it has to do with the &lt;code&gt;NaN&lt;/code&gt;. Why &lt;code&gt;NaN&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;Now, what will be the output of &lt;code&gt;&amp;#39;a&amp;#39; + + &amp;#39;b&amp;#39; + &amp;#39;c&amp;#39;&lt;/code&gt;. &lt;code&gt;aNaNc&lt;/code&gt;. Quite understandable. Right?&lt;/p&gt;
&lt;p&gt;Now, tell me, what will be the output of &lt;code&gt;&amp;#39;a&amp;#39; + + &amp;#39;b&amp;#39; + 2&lt;/code&gt;. Obviously, &lt;code&gt;aNaN2&lt;/code&gt;. Correct.&lt;/p&gt;
&lt;p&gt;But, what will be the output of &lt;code&gt;&amp;#39;a&amp;#39; + + 2&lt;/code&gt;. Can you guess? Shockingly, but not so unexpectedly, it’s &lt;code&gt;a2&lt;/code&gt;. We know, there is some relation of string concatenations with numbers. So, &lt;code&gt;2&lt;/code&gt; has absorbed the &lt;code&gt;NaN&lt;/code&gt; and hence the result. But what is the relation of string concatenation with &lt;code&gt;Numbers&lt;/code&gt;. I’m a little confused. But I’ll try to find the answer.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;We use string concatenations in JavaScript frequently. But if we look closely, it may raise a few new confusions. So, let’s begin.&lt;/p&gt;
&lt;p
    
    </summary>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/JavaScript/"/>
    
      <category term="Puzzle" scheme="http://coderuse.com/categories/JavaScript/Puzzle/"/>
    
      <category term="Interesting" scheme="http://coderuse.com/categories/JavaScript/Puzzle/Interesting/"/>
    
      <category term="Programming Language" scheme="http://coderuse.com/categories/JavaScript/Puzzle/Interesting/Programming-Language/"/>
    
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
      <category term="string" scheme="http://coderuse.com/tags/string/"/>
    
  </entry>
  
  <entry>
    <title>A Short Refresher On Git</title>
    <link href="http://coderuse.com/2017/10/A-Short-Refresher-On-Git/"/>
    <id>http://coderuse.com/2017/10/A-Short-Refresher-On-Git/</id>
    <published>2017-10-13T15:44:45.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://git-scm.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Git&lt;/a&gt; is the most popular version control management tool/system today. Being distributed in nature, it facilitates lower risk of losing the whole repo out-of-the-blue. Because, user always has a copy of the repo. And there are a lot of vendors, offering hosted git server. And most the offerings are free with a reasonable limit.&lt;/p&gt;
&lt;p&gt;I’ve been using Git for quite a long time. Though I’m not that much familiar with advanced concepts or complex scenarios regarding Git. To do day-to-day normal tasks, mostly I use only six commands(&lt;code&gt;status&lt;/code&gt;, &lt;code&gt;commit&lt;/code&gt;, &lt;code&gt;branch&lt;/code&gt;, &lt;code&gt;checkout&lt;/code&gt;, &lt;code&gt;push&lt;/code&gt;, &lt;code&gt;pull&lt;/code&gt;), with some flags some times. It’s true that I don’t do very complex things with it. But those four commands are enough for me. In this post, I’m iterating those commands one-by-one, possibly with some comments.&lt;/p&gt;
&lt;p&gt;Okay, let’s start by creating a &lt;code&gt;git&lt;/code&gt; repo with &lt;code&gt;init&lt;/code&gt; command.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mkdir new_git_repo_folder&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; new_git_repo_folder&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It’s as simple as that. After running this command, you can see, one folder with name &lt;code&gt;.git&lt;/code&gt; has been created. This folder is going to hold all the meta information for the repository. Git actually maintains &lt;code&gt;hash&lt;/code&gt; for a particular commit. Those information also reside in this folder. Now create some content.&lt;/p&gt;
&lt;p&gt;Most of the Git host servers shows the content of &lt;code&gt;README.md&lt;/code&gt; as default face of a directory. It’s kind of &lt;code&gt;index.html&lt;/code&gt; in a website. The extension &lt;code&gt;.md&lt;/code&gt; stands for &lt;code&gt;mark-down&lt;/code&gt;. It’s a pre-defined format to write documents, that can be converted into HTML/PDF or any other type, by some tool. There are a lot of implementation of this converter. Though there is a standard for the syntax for &lt;code&gt;mark-down&lt;/code&gt; but it mostly depend on the converter in use. GitHub, GitLab, Bitbucket all have implemented their own version of &lt;code&gt;mark-down&lt;/code&gt; to &lt;code&gt;HTML&lt;/code&gt; converter. Though their most of the syntaxes are same, there are some extras also. But for now, we don’t have to bother with the &lt;code&gt;mark-down&lt;/code&gt; syntax compatibility of various providers. We are gonna just add one &lt;code&gt;README.md&lt;/code&gt; file.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;# New Git Repo&quot;&lt;/span&gt; &amp;gt; README.md&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The leading &lt;code&gt;#&lt;/code&gt; will tell the converter to make the title as &lt;code&gt;h1&lt;/code&gt; element in &lt;code&gt;HTML&lt;/code&gt;. Git has two very important concepts. &lt;code&gt;HEAD&lt;/code&gt; and &lt;code&gt;stage&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git add README.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git status&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Add the user info to the local repo.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git config user.name &lt;span class=&quot;string&quot;&gt;&quot;Arnab Das&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git config user.email &lt;span class=&quot;string&quot;&gt;&quot;arnab@coderuse.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Add user info for the work environment.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git config --global user.name &lt;span class=&quot;string&quot;&gt;&quot;Arnab Das&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git config --global user.email &lt;span class=&quot;string&quot;&gt;&quot;arnab@coderuse.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now commit.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git commit -m &lt;span class=&quot;string&quot;&gt;&quot;Adding README.md&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# or, to add author in commit itself&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git commit --author &lt;span class=&quot;string&quot;&gt;&quot;Arnab Das &amp;lt;arnab@coderuse.com&amp;gt;&quot;&lt;/span&gt; -m &lt;span class=&quot;string&quot;&gt;&quot;Adding README.md&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git status&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Add the remote. It’s possible to mention the name of the remote other than &lt;code&gt;origin&lt;/code&gt;. It’s just the most common one.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git add remote origin &amp;lt;origin-url&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# for the first time it&#39;s required to mention the remote name and branch name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# the -u flag persists the mapping of the local to remote branch&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# later just &quot;git push&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push -u origin master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Create new branch and &lt;code&gt;checkout&lt;/code&gt; to the branch.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git checkout -b new_branch&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# do some changes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push -u origin new_branch&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Clone a git repo.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; &amp;lt;git-repo-url&amp;gt; [optional-folder-name]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; new_git_repo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Checkout to a branch. Both the following commands does the same thing. Creates a local branch named &lt;code&gt;new_branch&lt;/code&gt; from the remote branch &lt;code&gt;new_branch&lt;/code&gt;. Only difference is that, it’s possible to mention a different branch name in the first command.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git checkout -b new_branch origin/new_branch&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# or&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git checkout -t origin/new_branch&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;See the branch names.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lists only the local branches&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git branch&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lists local along with remote branches&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git branch &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# search for a branch name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git branch --all | grep &amp;lt;string-to-search-for-in-branch-names&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Delete a branch locally.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git branch &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt; &amp;lt;branch-name&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# if branch has some new commits delete forcefully&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git branch -D &amp;lt;branch-name&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Delete the branch in remote.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git push &amp;lt;remote-name&amp;gt; :&amp;lt;branch-to-delete&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://git-scm.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Git&lt;/a&gt; is the most popular version control management tool/system today. B
    
    </summary>
    
      <category term="System" scheme="http://coderuse.com/categories/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/System/Technical/"/>
    
    
      <category term="bash" scheme="http://coderuse.com/tags/bash/"/>
    
      <category term="git" scheme="http://coderuse.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Socks proxy and shadowsocks</title>
    <link href="http://coderuse.com/2017/05/socks-proxy-and-shadowsocks/"/>
    <id>http://coderuse.com/2017/05/socks-proxy-and-shadowsocks/</id>
    <published>2017-05-24T03:57:18.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Recently I had an interesting encounter with SSH tunneling. I was searching for some option to access one VPS with Scaleway, with no public access from outside. I’ve another VPS in Scaleway with public access. Actually VPS with no public IP comes at €1.99/per month. I was thinking to host one MySQL server in that VPS. But the main problem arose, was how to access that server. After some search, I came to know, SSH tunneling is ideal for this scenario and it’s very easy to do also. In my office I use Windows workstation. There I’ve installed Git and for that I get Git Bash. And during installation I had checked the option to make all the unix tools available in path. So, I can use &lt;code&gt;ssh&lt;/code&gt;, &lt;code&gt;ls&lt;/code&gt;, &lt;code&gt;mkdir&lt;/code&gt;, &lt;code&gt;awk&lt;/code&gt;, &lt;code&gt;grep&lt;/code&gt;, &lt;code&gt;rm&lt;/code&gt;, &lt;code&gt;sed&lt;/code&gt; all the useful commands. SSH is tunnel is also possible with &lt;a href=&quot;https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Putty&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are three types of tunnels can be made with &lt;code&gt;ssh&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;local&lt;/li&gt;
&lt;li&gt;remote&lt;/li&gt;
&lt;li&gt;dynamic&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Of this three, the last one &lt;code&gt;dynamic&lt;/code&gt; is of real interest for us, in regard to the socks proxy. But before that, let’s get into that topic slowly. First let’s review the other two and see their possibility and scope.&lt;/p&gt;
&lt;h4 id=&quot;Local-Tunnels&quot;&gt;&lt;a href=&quot;#Local-Tunnels&quot; class=&quot;headerlink&quot; title=&quot;Local Tunnels&quot;&gt;&lt;/a&gt;Local Tunnels&lt;/h4&gt;&lt;p&gt;Local tunnels make remote resources available locally. Suppose a MySQL server is running on the remote machine A behind a firewall and we have ssh access to another machine B in the same network as A. Then to access the MySQL server in A, we can invoke,&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# -N: do not execute remote commands&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# -L: bind address locally&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# local_port:A_IP or A_FQDN:A_Port_To_Bind&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# binding to the local port 3309 with the remote port 3309&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh -N -L &lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt;:aa.aa.aa.aa:&lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt; username_on_B@bb.bb.bb.bb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# another usecase, though not so practical, if A is accessible&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# and for some reason MySQL port is required as local port&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh -N -L &lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt;:aa.aa.aa.aa:&lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt; username_on_A@aa.aa.aa.aa&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# optionally if local is bound to more than one IP address&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# it is possible to specify local IP to bind&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh -N -L ll.ll.ll.ll:&lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt;:aa.aa.aa.aa:&lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt; username_on_A@aa.aa.aa.aa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Remote-Tunnels&quot;&gt;&lt;a href=&quot;#Remote-Tunnels&quot; class=&quot;headerlink&quot; title=&quot;Remote Tunnels&quot;&gt;&lt;/a&gt;Remote Tunnels&lt;/h4&gt;&lt;p&gt;This kind of tunnels are rarely used. It’s just opposite to the previous one. Instead of using &lt;code&gt;-L&lt;/code&gt; we have to use &lt;code&gt;-R&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# the host part is mandatory, so we have to use either of&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 127.0.0.1, localhost, 0.0.0.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh -R &lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3309&lt;/span&gt; username_on_B@bb.bb.bb.bb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Dynamic-Tunnels&quot;&gt;&lt;a href=&quot;#Dynamic-Tunnels&quot; class=&quot;headerlink&quot; title=&quot;Dynamic Tunnels&quot;&gt;&lt;/a&gt;Dynamic Tunnels&lt;/h4&gt;&lt;p&gt;This is of the most interest regarding the discussion about SOCKS proxy. For dynamic tunnels, we don’t have to give any specific remote port, though we have use one specific local port, that we want to pass all our traffic through.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# choice of local port is very important, but the ports&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 465, 587, 993 generally kept open even in very restrictive environments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh -D &lt;span class=&quot;number&quot;&gt;8888&lt;/span&gt; username_on_B@bb.bb.bb.bb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Dynamic tunnels creates light weight SOCKS proxy, that we can use to annonymize our browsing. SOCKS proxy is app level proxy. So it works at Application Chrome and IE uses system proxy. But in Firefox, we can set proxy. Paste &lt;code&gt;about:preferences#advanced&lt;/code&gt; in the address-bar of Firefox and enter. Click on the &lt;code&gt;Settings&lt;/code&gt; button related to &lt;code&gt;Connection&lt;/code&gt;. Choose &lt;code&gt;Manual Proxy Configuration&lt;/code&gt;, put &lt;code&gt;127.0.0.1&lt;/code&gt; in the host and specified port for &lt;code&gt;Socks Host&lt;/code&gt;. Leave all the others blank.&lt;/p&gt;
&lt;p&gt;Don’t forget to check the option &lt;code&gt;Proxy DNS when using SOCKS v5&lt;/code&gt;. This option is available in newer version of Firefox. If this is checked, Firefox will try to use the DNS of the remote host, through which the proxy has been configured.&lt;/p&gt;
&lt;p&gt;Also, we need to prevent the &lt;code&gt;WebRTC&lt;/code&gt; leak. Type &lt;code&gt;about:config&lt;/code&gt; in the address-bar and enter. Click on the button containing the text &lt;code&gt;I accept the risk&lt;/code&gt; or similar like it. Search for &lt;code&gt;media.peerconnection.enabled&lt;/code&gt; and double click it to make this flag false.&lt;/p&gt;
&lt;p&gt;Navigate to the site &lt;a href=&quot;https://ipleak.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ipleak.net&lt;/a&gt; and see if the intended IP is shown. Also don’t forget to check the DNS list. Sometimes DNS list exposes our actual location. If the DNS of your ISP is shown, try to change the nameserver inside the router or network adapter of PC. Google DNS or Free DNS responses are quite fast.&lt;/p&gt;
&lt;h4 id=&quot;socks5-proxy-with-ShadowSocks&quot;&gt;&lt;a href=&quot;#socks5-proxy-with-ShadowSocks&quot; class=&quot;headerlink&quot; title=&quot;socks5 proxy with ShadowSocks&quot;&gt;&lt;/a&gt;socks5 proxy with ShadowSocks&lt;/h4&gt;&lt;p&gt;Dynamic tunnels make use of SSH protocol to exchange network packets. A more sophisticated and secure option may be Shadowsocks. This uses altogether a new protocol. And it uses a different approach to encrypt and decrypt network packets. On top of Socks5, it uses a pre-specified password in server and client both to encrypt and decrypt. So, if the password is secure enough, it’s next to impossible to decrypt the packets.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://shadowsocks.org/en/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Shadowsocks&lt;/a&gt; is very easy to configure. Unless we are deploying it as a service, it does not require much resource also. For personal use, low end servers from Linode, Vultr, Digital Ocean, Amazon Lightsail, Scaleway, Rackulous, Contabo can be used. All the them have reasonably good performance and reputation as VPS providers. Here three things should be considered during the selection of provider,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;location&lt;/li&gt;
&lt;li&gt;price&lt;/li&gt;
&lt;li&gt;bandwidth&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I’m using Linode with 1GB RAM, 1 shared CPU core, 1 TB bandwidth for the minimum plan of $5 per month. Performance of the VPS is pretty decent and as I’m using &lt;code&gt;shadowsocks-libev&lt;/code&gt;, it’s almost nothing on the server. &lt;code&gt;shadowsocks-libev&lt;/code&gt; is a Shadowsocks implementation in &lt;em&gt;C&lt;/em&gt;. So, it’s fast and requires less resource. Other options can be viewed from &lt;a href=&quot;https://shadowsocks.org/en/download/servers.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here I’m giving a no-frill instructions to setup a Shadowsocks server on Ubuntu 16.04.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install required softwares&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt-get install --no-install-recommends build-essential autoconf libtool haveged automake \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        libssl-dev gawk debhelper dh-systemd init-system-helpers pkg-config asciidoc \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        xmlto apg libpcre3-dev zlib1g-dev libev-dev libudns-dev libsodium-dev libmbedtls-dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/src&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/shadowsocks/shadowsocks-libev.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git submodule update --init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# build and install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./autogen.sh &amp;amp;&amp;amp; ./configure &amp;amp;&amp;amp; make &amp;amp;&amp;amp; make install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# this is a hack to create the autostart scripts&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;add-apt-repository ppa:max-c-lv/shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt install shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# configure the server correctly&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vim /etc/shadowsocks-libev/config.json&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt-get remove shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# change the &quot;DAEMON&quot; localtion to &#39;/usr/local/bin/ss-server&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vim /etc/init.d/shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make the server configuration file as specified below&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# reload reload daemons&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl daemon-reload&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# restart the server&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/init.d/shadowsocks-libev restart &lt;span class=&quot;comment&quot;&gt;# if any error occurs try with just &#39;start&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Server configuration should be put in the file &lt;code&gt;/etc/shadowsocks-libev/config.json&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;server&lt;/span&gt;&quot;:&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;xx.xx.xx.xx&quot;&lt;/span&gt;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;server_port&lt;/span&gt;&quot;: &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;1234&lt;/span&gt;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;local_port&lt;/span&gt;&quot;: &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;1234&lt;/span&gt;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;password&lt;/span&gt;&quot;:&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;long-non-guessable-password&quot;&lt;/span&gt;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;timeout&lt;/span&gt;&quot;: &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;600&lt;/span&gt;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;&lt;span class=&quot;attribute&quot;&gt;method&lt;/span&gt;&quot;:&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;chacha20-ietf-poly1305&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;There are a lot of options for &lt;a href=&quot;https://shadowsocks.org/en/download/clients.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;clients of Shadowsocks&lt;/a&gt;. Install on Android or iPhone or on desktop and start to use proxy anywhere. I personally use on my Android set. It does not drain battery like the openVPN clients.&lt;/p&gt;
&lt;p&gt;Though proxy is used for anonymity. It helps us to keep ourselves private. But let’s not use this to harm someone. Great power comes with great responsibility. Use them carefully.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      Socks proxy is a lightweight alternative for VPN. May be this statement is a little overdo. But sometimes we really need a socks proxy, where VPN is really not an option. Firefox (more-ly with the option for &quot;Proxy DNS&quot; in newer versions) with socks is a great combination, when anonymous browsing is required.
    
    </summary>
    
      <category term="Anonymous" scheme="http://coderuse.com/categories/Anonymous/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/Anonymous/Cookbook/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/Anonymous/Cookbook/Technical/"/>
    
    
      <category term="proxy" scheme="http://coderuse.com/tags/proxy/"/>
    
      <category term="shadowsocks" scheme="http://coderuse.com/tags/shadowsocks/"/>
    
      <category term="socks5" scheme="http://coderuse.com/tags/socks5/"/>
    
  </entry>
  
  <entry>
    <title>Creating our own discussion forum with Slack</title>
    <link href="http://coderuse.com/2017/05/Creating-our-own-discussion-forum-with-Slack/"/>
    <id>http://coderuse.com/2017/05/Creating-our-own-discussion-forum-with-Slack/</id>
    <published>2017-05-17T09:29:47.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Recently I’ve created one &lt;a href=&quot;https://coderuse.slack.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;team&lt;/a&gt; in &lt;a href=&quot;https://slack.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Slack&lt;/a&gt;. It’s basically an effort to communicate with all, who wants to communicate with me. In one way it’s an &lt;a href=&quot;https://github.com/sindresorhus/ama&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AMA&lt;/a&gt; from me. I don’t know if someone wants to contact with me or not. But at-least I should keep some channels open to connect.&lt;/p&gt;
&lt;p&gt;I really appreciate this AMA initiative by &lt;a href=&quot;https://sindresorhus.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sindre Sorhus&lt;/a&gt;. And I think that everyone should keep open some channel to contact. Not email. Because email lacks the visibility for everyone. Email is good for one-to-one communication. But forum conversations are generally meant for publicly visible. Conversations as GitHub’s issue-comment presentation is a overkill, if not a little awkward. So, I was searching for an alternative to start my AMA. I like the UI of the currently popular traditional forum softwares, like &lt;a href=&quot;https://www.vbulletin.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vBulletin&lt;/a&gt;, &lt;a href=&quot;https://www.phpbb.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;phpBB&lt;/a&gt; and &lt;a href=&quot;https://www.google.com/search?q=forum+softwares&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;many others&lt;/a&gt;. But main problem with them is, I’ve to host them personally and hosting a public facing forum needs a lot of time and experience, which I don’t have. There are also some choices for free forum hosting. But, they gives annoying ads all over the pages and have some irrational constraints like limit on users (how can, or why should I put restrictions on user registrations, after all it’s purpose is to communicate with all. I’m not saying my forum is going to be that big. But at-least I should have no such limitations.), limit on posts (this is another disturbing limitation) etc.&lt;/p&gt;
&lt;p&gt;Slack has become popular for quite some time. And I really like the UI and it’s made for conversation. But one problem with the Slack teams, is joining of new members is depended upon invitation. It’s a little obstacle. Though this can be overcome if we can automate the sending of invitations. And fortunately there are some opensource projects, already solved the problem. One of the projects of this sort is &lt;a href=&quot;https://github.com/rauchg/slackin&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Slackin&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Slackin is a really simple web app with NodeJs backend. It’s simple to host and modify. But it needs one backend. Can’t be hosted with GitHub pages. There are a few free options like heroku, openshift to host a NodeJs application. Heroku does not accept custom domains with free plan. So, my obvious choice is always &lt;a href=&quot;https://www.openshift.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Openshift&lt;/a&gt; in such cases. Openshift’s previous version was more generous towards the free plan. There was no mandatory sleep time, like with the new version (Openshift’s version 3 requires at-least 18 hours of sleep time in a contiguous span of 72 hours). I’ve an account with the previous version. So, I could configure Slackin with one &lt;a href=&quot;https://developers.openshift.com/overview/basic-terminology.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gear&lt;/a&gt; (in-simple-words &lt;em&gt;containers&lt;/em&gt; are termed as &lt;em&gt;gear&lt;/em&gt; in Openshift’s terminogy).&lt;/p&gt;
&lt;p&gt;I’ve modified Slackin a little. In original software there is no check for spam. Though it does not matter if invitations are generated with automated scripts, as all the requests will be submitted to Slack. But, it’s better to have means to prevent spams in all publicly accessible websites. I have also checked that, Slack server is not testing the requested emails for invitation. Invitation requests to Slack’s API with email adddresses like, &lt;a href=&quot;mailto:`a@b.c&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;`a@b.c&lt;/a&gt;` is returning success. So, it’s needed to employ a captcha at-least to prevent spams upto some level.&lt;/p&gt;
&lt;p&gt;I’ve used Google &lt;a href=&quot;https://www.google.com/recaptcha/intro/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Recaptcha&lt;/a&gt;. It’s simple to integrate to websites and innovative. Really. You should try this. If havn’t already.&lt;/p&gt;
&lt;p&gt;Slackin’s &lt;a href=&quot;https://github.com/rauchg/slackin/wiki/OpenShift&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;guide&lt;/a&gt; to host with Openshift didn’t work for me. So, I modified the Slackin code to incorporate recaptcha and used different template to deploy the app to Openshift.&lt;/p&gt;
&lt;p&gt;Let’s dive into the details of deploying Slackin with Openshift. I’m writing this conforming to my modifications of the original app. But this guide should work with the original app and different enviroment than Openshift also.&lt;/p&gt;
&lt;p&gt;First let’s create one recaptcha token for our site. Go to &lt;a href=&quot;https://www.google.com/recaptcha/intro/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Recaptcha site&lt;/a&gt;. Click on “&lt;em&gt;Get Recaptcha&lt;/em&gt;“ and login with the desired Google login. Register a new site to the bottom of the page. Choose “Recaptcha V2”. Give the domain or subdomain name. By giving the domain name, all the subdomains to that domain are also authorised to use the same token. We’ve to use this feature wisely. And we’ve to include &lt;code&gt;localhost&lt;/code&gt;, to test the recaptcha during development.&lt;/p&gt;
&lt;p&gt;Next, we’ve to create one Slack team, where we will invite everyone to join. And create API token to authorize our app to Slack servers. So, head over to &lt;a href=&quot;https://slack.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Slack website&lt;/a&gt; and click on &lt;code&gt;Create Team&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Once the procedure of creating team and validation of email is complete, login to the Slack account and head over to create new token &lt;a href=&quot;https://api.slack.com/custom-integrations/legacy-tokens&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So, the tokens we’ll use, Slack team calls legacy token, as they have introduced OAUTH app style authorization with &lt;code&gt;client secret&lt;/code&gt; and &lt;code&gt;client id&lt;/code&gt;. &lt;em&gt;Legacy Token&lt;/em&gt; is fine. There are nothing wrong with it. Let’s work with it for now. Later I’ll try to modify this app to work with the new authorization.&lt;/p&gt;
&lt;p&gt;Now, let’s clone the &lt;a href=&quot;https://github.com/arnabdas/slackin&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;repo&lt;/a&gt; in your workstation. And install NPM packages and run the application to test.&lt;/p&gt;
&lt;p&gt;If NodeJs is not installed in the workstation it can be downloaded from &lt;a href=&quot;https://nodejs.org/en/download/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt; and installed.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/arnabdas/slackin.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; slackin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install npm packages&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# see the options can be passed to the application&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm ./bin/slackin -h&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# now run the application&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node ./bin/slackin -k &amp;lt;recaptcha-site-key&amp;gt; -r &amp;lt;recaptcha-secret&amp;gt; -o &amp;lt;slack-team-name&amp;gt; -t &amp;lt;slack-legacy-token&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Test whether the recaptcha widget is loaded properly, once the captcha is confirmed and invitation is requested with valid email id, invitation link is received by the provided email id or not. Once it’s configured properly, it’s time to deploy the application to Openshift.&lt;/p&gt;
&lt;p&gt;For Openshift install &lt;code&gt;rhc&lt;/code&gt; by following &lt;a href=&quot;https://developers.openshift.com/managing-your-applications/client-tools.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this&lt;/a&gt;. Invoke &lt;code&gt;rhc setup&lt;/code&gt; to login to Openshift from console and configure the workstation to work with Openshift API.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# create slacin application in Openshift cloud&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rhc app-create slackin https://raw.githubusercontent.com/arnabdas/openshift-cartridge-nodejs/master/metadata/manifest.yml&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# $RECAPTCHA_SITE_KEY -&amp;gt; Google recaptcha site key&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# $RECAPTCHA_SECRET -&amp;gt; Google recaptcha secret&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# $SLACK_SUBDOMAIN -&amp;gt; Slack team&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# $SLACK_API_TOKEN -&amp;gt; Slack legacy token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rhc env-set &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; slackin RECAPTCHA_SITE_KEY=&lt;span class=&quot;string&quot;&gt;&quot;recaptcha-site-key&quot;&lt;/span&gt; RECAPTCHA_SECRET=&lt;span class=&quot;string&quot;&gt;&quot;recaptcha-secret&quot;&lt;/span&gt; SLACK_SUBDOMAIN=&lt;span class=&quot;string&quot;&gt;&quot;slack-team-name&quot;&lt;/span&gt; SLACK_API_TOKEN=&lt;span class=&quot;string&quot;&gt;&quot;slack-legacy-token&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# if custom domain to be configured for the app&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# create one CNAME record for this custom domain to the Openshift app url&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rhc &lt;span class=&quot;built_in&quot;&gt;alias&lt;/span&gt;-add &amp;lt;custom-domain&amp;gt; &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; slackin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# add Openshift remote to the git repo to checkin the code to the Openshift repo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git remote add openshift `rhc app-show slackin | grep Git | sed &lt;span class=&quot;string&quot;&gt;&#39;s/^.*ssh/ssh/&#39;&lt;/span&gt;`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# now push to Openshift&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push openshift master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It should go fine and the app should be available at the intended url. And we’ve got our own forum. Cheers. Happy coding. :)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      This is a small DIY to automate sending invitation for your Slack team. With Slack team, you can create create your own forum and invite people to join and discuss about interesting stuff. This makes use of the Slackin project. I&#39;ve included Google recaptcha to prevent spam registrations. And the deployment has been done on Openshift.
    
    </summary>
    
      <category term="Slack" scheme="http://coderuse.com/categories/Slack/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/Slack/Cookbook/"/>
    
      <category term="Forum" scheme="http://coderuse.com/categories/Slack/Cookbook/Forum/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/Slack/Cookbook/Forum/Technical/"/>
    
    
      <category term="forum" scheme="http://coderuse.com/tags/forum/"/>
    
      <category term="free" scheme="http://coderuse.com/tags/free/"/>
    
      <category term="slack" scheme="http://coderuse.com/tags/slack/"/>
    
      <category term="team-conversation" scheme="http://coderuse.com/tags/team-conversation/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript Objects, Functions aka Classes In ES5</title>
    <link href="http://coderuse.com/2016/09/JavaScript-Objects-Functions-Classes-In-ES5/"/>
    <id>http://coderuse.com/2016/09/JavaScript-Objects-Functions-Classes-In-ES5/</id>
    <published>2016-09-20T08:55:07.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;JavaScript has five primitive data types: string, number, boolean, null and undefined. And operators like, &lt;code&gt;+&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt;, &lt;code&gt;typeof&lt;/code&gt;, &lt;code&gt;instanceof&lt;/code&gt; etc. Other than these, everything else are objects. Even functions are objects, can be created by invoking by &lt;code&gt;Function&lt;/code&gt; constructor and &lt;code&gt;typeof&lt;/code&gt; on a function returns &lt;code&gt;function&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// new Function([arg1[, arg2[, ...argN]],] functionBody)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; animal = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Function&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;legs&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;this.legs = legs;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// check the type&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; animal); &lt;span class=&quot;comment&quot;&gt;// function&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create an object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; animal(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// and check if the value has been assigned or not &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a.legs); &lt;span class=&quot;comment&quot;&gt;// 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;JavaScript interpreter does not enforce it, but it’s a common convention, the name of the functions, which are not intended to be used as &lt;code&gt;class&lt;/code&gt;es, starts with a small letter and follows the conventions of &lt;a href=&quot;https://en.wikipedia.org/wiki/CamelCase&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;camelCase&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Functions in JavaScript either used as a block of codes, to be executed upon call or create objects with properties assigned to the function or to its prototype.&lt;/p&gt;
&lt;p&gt;Though operators seems to work like function, but by nature they are special kind of entity, which can’t be assigned and always needs operand(s) to operate on. That means, we can’t write &lt;code&gt;var o = +;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Objects can be created by two ways.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// by object literal&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; obj = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// by using constructor functions&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; classObj = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Animal(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;JavaScript objects are basically representations of data-structure of key-value pair. And they can be iterated. And in modern browsers we don’t need to check with &lt;code&gt;.hasOwnProperty&lt;/code&gt; as &lt;a href=&quot;http://stackoverflow.com/questions/8312459/iterate-through-object-properties&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;with the old browsers&lt;/a&gt;. Now we can simply do by &lt;code&gt;for...in&lt;/code&gt; loop.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create the object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  name: &lt;span class=&quot;string&quot;&gt;&quot;Simon&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  age: &lt;span class=&quot;string&quot;&gt;&quot;20&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  clothing: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    style: &lt;span class=&quot;string&quot;&gt;&quot;simple&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hipster: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// iterate over the properties of the objects&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; propt &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; obj)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (obj.hasOwnProperty(propt)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(propt + &lt;span class=&quot;string&quot;&gt;&#39;: &#39;&lt;/span&gt; + obj[propt]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;We can add properties to objects by two methods. Either declare properties at the time of creating the objects as the previous example or later assign by &lt;code&gt;value-of&lt;/code&gt; notation.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// use the string literals directly&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;obj[&lt;span class=&quot;string&quot;&gt;&#39;literal&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;literal value&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// or dynamically set the property by variables&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; property = &lt;span class=&quot;string&quot;&gt;&#39;dynamicProperty&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;obj[property] = &lt;span class=&quot;string&quot;&gt;&#39;dynamic property value&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To delete a property from an object we can use &lt;code&gt;delete&lt;/code&gt; keyword.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// directly delete the property if known&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; obj.name;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// dynamically assign property name to delete&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; toDeleteKey = &lt;span class=&quot;string&quot;&gt;&#39;age&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; obj[toDeleteKey];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(obj)); &lt;span class=&quot;comment&quot;&gt;// &amp;#123;&quot;clothing&quot;:&amp;#123;&quot;style&quot;:&quot;simple&quot;,&quot;hipster&quot;:false&amp;#125;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;By default type of any object, created programmatically is &lt;code&gt;object&lt;/code&gt; and parent is &lt;code&gt;undefined&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; obj = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; obj); &lt;span class=&quot;comment&quot;&gt;// object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Prior to ES-2015, there was no notion of classes in JavaScript, though &lt;code&gt;class&lt;/code&gt; was a reserved keyword. So, until ES-2015, generally classes were reprsented as functions. And with functions, we can even derive one class into another, using the prototypal inheritance of JavaScript. There are several versions of deriving one class into another, and we can use one of these ways, as per the requirement and choice.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// declare class - &#39;Animal&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Animal&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.legs = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Animal.prototype.legs = &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Animal.prototype.move = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;moving...&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// declare class - &#39;Tiger&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Tiger&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.class = &lt;span class=&quot;string&quot;&gt;&#39;mammal&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Unlike other programming languages, in JavaScript inheritance assigned after creation of class, through prototype. Here we will discuss various methods of deriving classes.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// assign a new object to the prototype of &#39;Tiger&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tiger.prototype = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Animal();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create a new object of type tiger&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; t = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Tiger();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.legs); &lt;span class=&quot;comment&quot;&gt;// 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.class); &lt;span class=&quot;comment&quot;&gt;// &#39;mammal&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.move()); &lt;span class=&quot;comment&quot;&gt;// moving...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;All things are fine and all the properties present in the prototype along with the properties declared in direct &lt;code&gt;closure&lt;/code&gt; of the super class has been derived to child class &lt;code&gt;Tiger&lt;/code&gt;. Programmatically and in using this type of construct don’t cause any problems.&lt;/p&gt;
&lt;p&gt;However, using &lt;code&gt;new&lt;/code&gt; with a prototypal language like JavaScript, seems like going against the tide. And in &lt;a href=&quot;http://javascript.crockford.com/prototypal.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this historic document&lt;/a&gt;, Crockford agrees to the fact, that JavaScript lacks the mechanism to inherit directly from another object. Instead it uses &lt;code&gt;function&lt;/code&gt; along with &lt;code&gt;new&lt;/code&gt; keyword.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This indirection was intended to make the language seem more familiar to classically trained programmers, but failed to do that, as we can see from the very low opinion Java programmers have of JavaScript. JavaScript’s constructor pattern did not appeal to the classical crowd. It also obscured JavaScript’s true prototypal nature. As a result, there are very few programmers who know how to use the language effectively.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Using &lt;code&gt;new&lt;/code&gt; keyword, actually causes a little deviation from being a pure &lt;code&gt;Prototypal Language&lt;/code&gt;. In modern browsers, there is a method called &lt;code&gt;create&lt;/code&gt; in the &lt;code&gt;Object&lt;/code&gt; prototype. This tries to fulfill the promise of a pure prototypal language.&lt;/p&gt;
&lt;p&gt;So, our previous example can be formatted as,&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// declare Animal class&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Animal&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.legs = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Animal.prototype.legs = &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// declare Tiger class&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Tiger&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.class = &lt;span class=&quot;string&quot;&gt;&#39;mammal&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create a new instance of Animal.prototype and&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// assign it to the Tiger.prototype&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tiger.prototype = &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.create(Animal.prototype);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// explicitly assign Tiger as the prototype&#39;s constructor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tiger.prototype.constructor = Tiger;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create instance of Tiger&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; t = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Tiger();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.legs); &lt;span class=&quot;comment&quot;&gt;// 8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.class); &lt;span class=&quot;comment&quot;&gt;// mammal&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;So, it didn’t call the &lt;code&gt;constructor&lt;/code&gt; of the &lt;code&gt;Animal&lt;/code&gt; class. We need to do that explicitly inside the &lt;code&gt;Tiger&lt;/code&gt; &lt;code&gt;constructor&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Tiger&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Animal.call(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// call Animal constructor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.class = &lt;span class=&quot;string&quot;&gt;&#39;mammal&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; t = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Tiger();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(t.legs); &lt;span class=&quot;comment&quot;&gt;// 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And if we are more into writing prototypically pure code, we should not even use functions as classes. Observe how the properties are created here. We can also control accesses of the properties. &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperties&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More details&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// create Animal class object creator&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function createAnimal () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  return Object.create(Object.prototype, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    legs: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      value: 4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    move: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      value: function () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        console.log(&#39;moving...&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// create Tiger class object creator&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function createTiger () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  return Object.create(createAnimal(), &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    class: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      value: &#39;mammal&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    move: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      value: function () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        console.log(&#39;moving in stealth mode...&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// create instance of Tiger class&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var t = createTiger();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;console.log(t.legs); // 4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;console.log(t.class); // mammal&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;t.move(); // moving in stealth mode...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;One benefit of using prototypal language is, it’s possible to use delegation instead of inheriting another class in order to re-use code.&lt;/p&gt;
&lt;p&gt;What is &lt;code&gt;delegation&lt;/code&gt;? Let’s understand that by an example.&lt;/p&gt;
&lt;p&gt;Suppose we have two classes &lt;code&gt;Mammal&lt;/code&gt; and &lt;code&gt;Reptile&lt;/code&gt;. By the genetic inheritance, we know that, there are almost no similarity between these two species. As designing classes means abstraction of real behavior, suppose for the sake of the program we have identified that, the movement of both of the classes are same. And some super enthusiastic developer has already implemented the &lt;code&gt;move&lt;/code&gt; function for the mammals.&lt;/p&gt;
&lt;p&gt;What can we do now. Derive the &lt;code&gt;Mammal&lt;/code&gt; into &lt;code&gt;Reptile&lt;/code&gt;, how odd it may look or sound. Or repeat the same method in &lt;code&gt;Reptile&lt;/code&gt;. But that will introduce redundant code. Or move out the function out of &lt;code&gt;Mammal&lt;/code&gt; and put in some &lt;code&gt;Utility&lt;/code&gt; object and use from both the classes as method call.&lt;/p&gt;
&lt;p&gt;As a prototypal language JavaScript gives another possibility. &lt;code&gt;Delegation&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We can directly use the &lt;code&gt;move&lt;/code&gt; function with an object of &lt;code&gt;Reptile&lt;/code&gt; class by the use of &lt;code&gt;call&lt;/code&gt; or &lt;code&gt;apply&lt;/code&gt; available in &lt;code&gt;Function&lt;/code&gt; prototype.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// create one object of reptile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; r = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Reptile();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// use call or apply to invoke the function &#39;move&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Mammal.move.apply(r, &lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Only constraint would be, &lt;code&gt;Reptile&lt;/code&gt; class should contain all the properties, required by the &lt;code&gt;move&lt;/code&gt; method in &lt;code&gt;Mammal&lt;/code&gt; class.&lt;/p&gt;
&lt;p&gt;But how this can be done?&lt;/p&gt;
&lt;p&gt;Here comes the concept of &lt;code&gt;closure&lt;/code&gt;. In JavaScript, there is no &lt;code&gt;block-scope&lt;/code&gt; as in other programming languages like Java, C++, C.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// i is available here&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i); &lt;span class=&quot;comment&quot;&gt;// 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Instead it defines &lt;code&gt;closure&lt;/code&gt; as the state of a function along with the scope of it. Let’s understand it by some examples.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; outside = &lt;span class=&quot;string&quot;&gt;&#39;Outside&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;a&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(outside); &lt;span class=&quot;comment&quot;&gt;// Outside&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(outside); &lt;span class=&quot;comment&quot;&gt;// Outside&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Let’s modify the code a little bit. We will declare the variable &lt;code&gt;outside&lt;/code&gt; again inside the function &lt;code&gt;a&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; outside = &lt;span class=&quot;string&quot;&gt;&#39;Outside&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;a&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(outside); &lt;span class=&quot;comment&quot;&gt;// undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; outside;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(outside); &lt;span class=&quot;comment&quot;&gt;// Outside&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Why it printed &lt;code&gt;undefined&lt;/code&gt;? Because inside the function the re-declaration of &lt;code&gt;outside&lt;/code&gt; hoisted and it overrided the prior declaration of the variable &lt;code&gt;outside&lt;/code&gt;. But, outside the function it remains same.&lt;/p&gt;
&lt;p&gt;Now, let’s take an interesting example of &lt;code&gt;closure&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;, &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It will print &lt;code&gt;4&lt;/code&gt; three times. But we expected that, it should print &lt;code&gt;1&lt;/code&gt;, &lt;code&gt;2&lt;/code&gt; then &lt;code&gt;3&lt;/code&gt;. Why it did that? Because, the closure, in which the expression &lt;code&gt;console.log(i);&lt;/code&gt; was executed, had &lt;code&gt;4&lt;/code&gt; as the value of &lt;code&gt;i&lt;/code&gt; at the time of execution.&lt;/p&gt;
&lt;p&gt;How can we correct this? simply by creating new &lt;code&gt;closure&lt;/code&gt; for each of the functions passed to &lt;code&gt;setTimeout&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  setTimeout((&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;) &lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// new closure&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;(i)), &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It’ll correctly print &lt;code&gt;1&lt;/code&gt;, &lt;code&gt;2&lt;/code&gt; then &lt;code&gt;3&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Is this the only way-out? No. We can also use &lt;code&gt;partial&lt;/code&gt; functions here. What are partial functions.&lt;/p&gt;
&lt;p&gt;In &lt;code&gt;Function&lt;/code&gt; prototype, there is one method, called &lt;code&gt;bind&lt;/code&gt;, which returns a function binding with the passed context and arguments. This blog contains a &lt;a href=&quot;http://coderuse.com/2016/04/JavaScript-bind-a-less-used-magic/&quot;&gt;previous post&lt;/a&gt; regarding usefulness of this function for a specific usecase. Here we can use &lt;code&gt;bind&lt;/code&gt; for this purpose.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;.bind(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, i), &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It’ll print &lt;code&gt;1&lt;/code&gt;, &lt;code&gt;2&lt;/code&gt; and &lt;code&gt;3&lt;/code&gt; in correct manner.&lt;/p&gt;
&lt;p&gt;Thank you for reading this. Be happy. :-)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;JavaScript has five primitive data types: string, number, boolean, null and undefined. And operators like, &lt;code&gt;+&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/JavaScript/"/>
    
      <category term="Inner Concepts" scheme="http://coderuse.com/categories/JavaScript/Inner-Concepts/"/>
    
      <category term="Programming Language" scheme="http://coderuse.com/categories/JavaScript/Inner-Concepts/Programming-Language/"/>
    
    
      <category term="functions" scheme="http://coderuse.com/tags/functions/"/>
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
      <category term="objects" scheme="http://coderuse.com/tags/objects/"/>
    
  </entry>
  
  <entry>
    <title>Configure GitLab backup into Amazon S3</title>
    <link href="http://coderuse.com/2016/09/Configure-GitLab-Backup-Into-Amazon-S3/"/>
    <id>http://coderuse.com/2016/09/Configure-GitLab-Backup-Into-Amazon-S3/</id>
    <published>2016-09-19T12:04:53.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;In the &lt;a href=&quot;/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/&quot;&gt;previous post&lt;/a&gt;, I tried to write a step by step procedure to install and configure a &lt;a href=&quot;https://about.gitlab.com/downloads/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitLab Community Edition Server&lt;/a&gt;. Now, whenever we are running a server with some kind of hosting, whatever that may be, site-hosting, file-hosting, image-hosting or any other kind of hosting, proper backup is needed. Whatever we do to protect our server, for a cloud vps, it’s unlikely, but it may crash, or for some un-known reason, hosting account may be suspended, or host may go down for bankruptsy or server’s IP may get banned and the site can’t be accessed due to the firewall of the ISP. So, there are many reasons, that can result in no-access-to-the-server. And as a precaution, we need to take backup of the server regularly.&lt;/p&gt;
&lt;p&gt;For GitLab, backup means backup of configuration and application data both. &lt;a href=&quot;https://docs.gitlab.com/omnibus/settings/backups.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More details&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To take backup, first we need to decide on the policy regarding storing the backup. Yes this is very important.&lt;/p&gt;
&lt;p&gt;It’s possible to take backup regularly, download the archive files to local computer and keep the archives in a convenient place. But, it’s good to have an automated process for this. And we should keep in mind that, our local machines can crash and if that happens, all the backups will go to vein. For this reason, we should select providers like &lt;a href=&quot;https://aws.amazon.com/s3/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AWS S3&lt;/a&gt;, &lt;a href=&quot;https://cloud.google.com/storage/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Google CLoud Storage&lt;/a&gt;, &lt;a href=&quot;https://www.rackspace.com/cloud/files&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RackSpace Cloud Files&lt;/a&gt; to store our backups. They have disater recovery processes and there is almost no chance that any file uploaded to these services, will be lost, unless we explicitly do this. GitLab depends on &lt;a href=&quot;http://fog.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Fog&lt;/a&gt; for uploading backups to remote locations. And &lt;code&gt;Fog&lt;/code&gt; supports only the above three cloud providers along with local storage. By comparing the pricing of the above three and considering the fact, mostly we will just upload and store the files, downloading will not happen very often, found that, AWS S3 has the least pricing. Refer to, &lt;a href=&quot;https://aws.amazon.com/s3/pricing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AWS S3 pricing&lt;/a&gt;, &lt;a href=&quot;https://cloud.google.com/storage/pricing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Google Cloud Storage pricing&lt;/a&gt; and &lt;a href=&quot;https://www.rackspace.com/cloud/files&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RackSpace Cloud Files pricing&lt;/a&gt;. Observe that, there are three types of storage in AWS S3 and Google Cloud Storage. We can decide that, initially we will upload the files to &lt;code&gt;Standard Storage&lt;/code&gt; and after some time move the files to &lt;code&gt;Glacier Storage&lt;/code&gt; of AWS or &lt;code&gt;Nearline Storage&lt;/code&gt; of Google and after a long period of time, say one year, we will actuallly delete the files. Beacause after such a long period, there will not remain any relevance of such old backup. In S3, we can explicitly set such rule. We will see.&lt;/p&gt;
&lt;p&gt;I’ve used AWS S3 to preserve the backed up data. If you want to use any other provider, this guide may not help you that much.&lt;/p&gt;
&lt;p&gt;Let’s start.&lt;/p&gt;
&lt;p&gt;Create one AWS account. If you’re an Amazon customer, you may either link the AWS account with the exisiting customer account or create a fresh one with new email. Amazon also gives a &lt;a href=&quot;https://aws.amazon.com/free/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;12 month free tier&lt;/a&gt;, upon signup of a new account. Here one credit or debit card &lt;a href=&quot;https://payments.amazon.com/help/201754650&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;eligible&lt;/a&gt; for online transaction is required. Open &lt;a href=&quot;https://aws.amazon.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AWS Console&lt;/a&gt;, click on the link/button &lt;strong&gt;Sign In to the Console&lt;/strong&gt; and complete the procedure to sign up and in the last page click on the link, something like &lt;strong&gt;Sign In to Console&lt;/strong&gt;. Check the email in the username box and select the &lt;em&gt;returning user&lt;/em&gt; radio button and enter the password.&lt;/p&gt;
&lt;p&gt;To create a &lt;a href=&quot;http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;bucket&lt;/a&gt;, think &lt;code&gt;bucket&lt;/code&gt; as a bowl to put your backups, go &lt;a href=&quot;https://console.aws.amazon.com/s3/home&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;. Click on the &lt;strong&gt;Create Bucket&lt;/strong&gt; button. Give the bucket name, you decided and select a region (here choice of region doesn’t matter seriously unless you have some constraint), and if you need logging, click on &lt;strong&gt;Enable Logging&lt;/strong&gt;, otherwise click on &lt;strong&gt;Create&lt;/strong&gt;. Your bucket is ready to take files.&lt;/p&gt;
&lt;p&gt;Here we have to set the &lt;code&gt;Lifecycle&lt;/code&gt; of the files. Click on the bucket, just created and click on the &lt;strong&gt;Properties&lt;/strong&gt; button if not selected in prior. Click &lt;strong&gt;Lifecycle&lt;/strong&gt; and create one rule. The wizard is self explaining. Fill it, at your own choice. I’ve set that, after 30 days, files would move to &lt;code&gt;Glacier Storage&lt;/code&gt; and after 365 days from the creation time the files will be deleted. Now, let’s move towards to create users to configure the automated backup process.&lt;/p&gt;
&lt;p&gt;It’s not recommended to use the root user, the user, you have logged with, in any of the automated tasks. Because if someone with malicious intent gets access to our server, severe damage can happen. So, create one IAM user &lt;a href=&quot;https://console.aws.amazon.com/iam/home&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;. Click on the &lt;strong&gt;Users&lt;/strong&gt; tab to the left and click on &lt;strong&gt;Create New User&lt;/strong&gt;. You can create upto 5 users at a time. Here we need only one user. Give the username. Keep the checkbox &lt;code&gt;Generate an access key for each user&lt;/code&gt; checked. Click &lt;strong&gt;Create&lt;/strong&gt; and in the next page download the credential by clicking on the button &lt;strong&gt;Download Credentials&lt;/strong&gt; and then click &lt;strong&gt;Close&lt;/strong&gt;. It’ll be better to create a group with proper inline policy, so that, it’ll be easier to manage user permissions.&lt;/p&gt;
&lt;p&gt;Click on the &lt;strong&gt;Groups&lt;/strong&gt; tab to the left. And create one group. Don’t attach any policy here. Just create the group. After creation, click on the group to open the details. Click on the &lt;strong&gt;Permissions&lt;/strong&gt; and open the accordion &lt;strong&gt;Inline Policies&lt;/strong&gt;. Click on the &lt;strong&gt;Click Here&lt;/strong&gt; link. And select the button corresponding to &lt;strong&gt;Policy Generator&lt;/strong&gt;. Select &lt;code&gt;S3&lt;/code&gt; from the dropdown of &lt;code&gt;AWS Service&lt;/code&gt;. And select the following actions for specified resources. &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# Resource - &amp;#34;arn:aws:s3:::&amp;#60;bucket-name&amp;#62;/*&amp;#34; &amp;#10;&amp;#34;s3:AbortMultipartUpload&amp;#34;,&amp;#10;&amp;#34;s3:GetBucketAcl&amp;#34;,&amp;#10;&amp;#34;s3:GetBucketLocation&amp;#34;,&amp;#10;&amp;#34;s3:GetObject&amp;#34;,&amp;#10;&amp;#34;s3:GetObjectAcl&amp;#34;,&amp;#10;&amp;#34;s3:ListBucketMultipartUploads&amp;#34;,&amp;#10;&amp;#34;s3:PutObject&amp;#34;,&amp;#10;&amp;#34;s3:PutObjectAcl&amp;#34;&amp;#10;&amp;#10;# Resource - &amp;#34;*&amp;#34;&amp;#10;&amp;#34;s3:GetBucketLocation&amp;#34;,&amp;#10;&amp;#34;s3:ListAllMyBuckets&amp;#34;&amp;#10;&amp;#10;# Resource - &amp;#34;arn:aws:s3:::&amp;#60;bucket-name&amp;#62;&amp;#34;&amp;#10;&amp;#34;s3:ListBucket&amp;#34;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;After putting the resource name each time click on &lt;strong&gt;Add Statement&lt;/strong&gt; and finally click on &lt;strong&gt;Next Step&lt;/strong&gt; and give a name of the policy and create it. The policy will be listed in the &lt;strong&gt;Permission&lt;/strong&gt; tab of the Group.&lt;/p&gt;
&lt;p&gt;Click on the &lt;strong&gt;Users&lt;/strong&gt; tab in the group details page. Click &lt;strong&gt;Add Users to Group&lt;/strong&gt; to add the user created previously.&lt;/p&gt;
&lt;p&gt;Now we have to configure our GitLab server to upload the backups to AWS. Open &lt;code&gt;/etc/gitlab/gitlab.rb&lt;/code&gt; in your favourite editor and add the search for the text &lt;code&gt;manage_backup_path&lt;/code&gt; and make the block like below. &lt;a href=&quot;https://docs.gitlab.com/ce/raketasks/backup_restore.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More Details&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight ruby&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;manage_backup_path&#39;&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;backup_path&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/path/to/backup/location/in/server&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# gitlab_rails[&#39;backup_archive_permissions&#39;] = 0644 # See: http://doc.gitlab.com/ce/raketasks/backup_restore.html#backup-archive-permissions&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# gitlab_rails[&#39;backup_pg_schema&#39;] = &#39;public&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# gitlab_rails[&#39;backup_keep_time&#39;] = 604800&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;backup_upload_connection&#39;&lt;/span&gt;] = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;string&quot;&gt;&#39;provider&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;AWS&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;string&quot;&gt;&#39;region&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;us-west-2&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;string&quot;&gt;&#39;aws_access_key_id&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;_secret_id_&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;string&quot;&gt;&#39;aws_secret_access_key&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;_secret_key_&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;backup_upload_remote_directory&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;bucket-name&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;backup_multipart_chunk_size&#39;&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;104857600&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gitlab_rails[&lt;span class=&quot;string&quot;&gt;&#39;backup_encryption&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;AES256&#39;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# Turns on AWS Server-Side Encryption with Amazon S3-Managed Keys for backups&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;For the codename of AWS regions, refer to &lt;a href=&quot;http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this&lt;/a&gt;. AWS secret access key id and access key can be found in the downloaded credential file, when the IAM user was created. Replace &lt;code&gt;bucket-name&lt;/code&gt; with proper name of the bucket, you had created in prior.&lt;/p&gt;
&lt;p&gt;Almost done. Now, we have to run only two commands.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# reconfigure GitLab with the modified configurations&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo gitlab-ctl reconfigure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# create first backup of the server&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo gitlab-rake gitlab:backup:create&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If all the steps have configured correctly, you should be able to see a &lt;code&gt;.tar&lt;/code&gt; file in the web view of the bucket.&lt;/p&gt;
&lt;p&gt;But, we don’t want to take backups manually. So, we will set a &lt;a href=&quot;https://en.wikipedia.org/wiki/Cron&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cronjob&lt;/a&gt; in our server. Invoke the command &lt;code&gt;sudo crontab -e -u root&lt;/code&gt;, or you may want specify the useid, running the GitLab server. If the crontab has not been configured, it will ask for the default editor, you want to use. Select one by giving one number. Then the &lt;code&gt;cron-file&lt;/code&gt; will be opened in the editor selected.&lt;/p&gt;
&lt;p&gt;Now, we have to understand a little bit about the syntax of the cron. It’s very easy. Just read &lt;a href=&quot;http://kvz.io/blog/2007/07/29/schedule-tasks-on-linux-using-crontab/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this&lt;/a&gt; once. By the knowledge, we just acquired, let’s add one line to the end of the cron file and save the file. Cron will automatically create one cronjob for it.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# it says that run the backup command on the 7th day, i.e. &amp;#10;# Saturday, depends on the server setting, at 23:59 hrs&amp;#10;# and the backup command will take care of creating backups&amp;#10;# and uploading them to AWS S3&amp;#10;59 23 * * 7 /usr/bin/gitlab-rake gitlab:backup:create&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;It completes the automation of taking backups of application data, i.e. repositories, databases etc.&lt;/p&gt;
&lt;p&gt;We are not finished yet. We need to take backup of the &lt;code&gt;/etc/gitlab&lt;/code&gt; folder also. But, as this folder does not change very frequently, decided to take backup of this folder manually. Specially if you have many users you may want to setup a cron job to create archives of this folder at regular intervals. Refer to &lt;a href=&quot;https://docs.gitlab.com/omnibus/settings/backups.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Code happily and be happy. :-)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;In the &lt;a href=&quot;/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/&quot;&gt;previous post&lt;/a&gt;, I tried to write a step by step pro
    
    </summary>
    
      <category term="CI" scheme="http://coderuse.com/categories/CI/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/CI/Cookbook/"/>
    
      <category term="System" scheme="http://coderuse.com/categories/CI/Cookbook/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/"/>
    
      <category term="Economical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/Economical/"/>
    
    
      <category term="ci" scheme="http://coderuse.com/tags/ci/"/>
    
      <category term="gitlab" scheme="http://coderuse.com/tags/gitlab/"/>
    
      <category term="private-git" scheme="http://coderuse.com/tags/private-git/"/>
    
  </entry>
  
  <entry>
    <title>Installation And Configuration Of GitLab Server With CI</title>
    <link href="http://coderuse.com/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/"/>
    <id>http://coderuse.com/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/</id>
    <published>2016-09-17T15:16:42.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Please select &lt;a href=&quot;http://releases.ubuntu.com/16.04/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu 16.04&lt;/a&gt;, if it’s possible, as the server os, for both the servers. I’m using this. I’ll try to write the steps as os agnostic as possible and shall try to give proper links to install for other distributions.&lt;/p&gt;
&lt;p&gt;And of-course put the domain/sub-domain name you are going to use as the name of the server. It’s required.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This is the second part of the series to configure a source control hosting. This post contains only installation steps. If you need any push to motivate youself to do this, you may find the first part helpful.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;/2016/09/How-I-Host-Private-GitLab-With-CI-For-Less-Than-Four-Euro/&quot;&gt;Here&lt;/a&gt; is the first part, regarding choice of hosting and some inspiration.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I’ve used the &lt;a href=&quot;https://docs.gitlab.com/omnibus/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Omnibus&lt;/a&gt; package for installation. Found this as most convenient one. And I’ve seen that, it’s possible to tweak all the services installed by this package. You can also opt for installation of individual components of GitLab. You can find lot of options &lt;a href=&quot;https://about.gitlab.com/installation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Before we start the installation, we need to log into the system by SSH and update our system. If you’re using any version of Linux or Mac, you have your terminal and the command &lt;code&gt;ssh&lt;/code&gt; is available. For Windows use &lt;a href=&quot;http://www.putty.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Putty&lt;/a&gt;. &lt;a href=&quot;http://www.wikihow.com/Use-SSH&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More details&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# first update the registry&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# upgrade if any update available&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get upgrade&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now follow the instructions described &lt;a href=&quot;https://about.gitlab.com/downloads&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt; for &lt;a href=&quot;https://about.gitlab.com/features/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitLab Community Edition Server&lt;/a&gt;. Instructions have been written quite clearly.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Select &lt;code&gt;Internet Site&lt;/code&gt; during Postfix installation&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It may happen that, your server provider has blocked the SMTP port by default. Check if mails are going from the server.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install mailutils&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;This is the body of the email&quot;&lt;/span&gt; | mail &lt;span class=&quot;operator&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;This is the subject line&quot;&lt;/span&gt; to@existingmail.address&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If not, configure the mail server properly. It’ll be needed by GitLab.&lt;/p&gt;
&lt;p&gt;But before executing the command &lt;code&gt;gitlab-ctl reconfigure&lt;/code&gt;, we have to do something to configure this server with SSL.&lt;/p&gt;
&lt;p&gt;Please don’t use the server with IP. Use a domain name with SSL. It’ll give a level of security inside the network layer. &lt;a href=&quot;https://www.sslshopper.com/why-ssl-the-purpose-of-using-ssl-certificates.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More details&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Theoretically you can use a IP for your server hostname. But, if you are configuring a git server for yourself. Give it a name. Even a subdomain like &lt;code&gt;subdomain.domain.tld&lt;/code&gt; looks good. And there are lots of providers selling cheap ssl certificates. Get one of them. I’ve seen &lt;a href=&quot;https://comodosslstore.com/promoads/cheap-comodo-ssl.aspx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Comodo Positive SSL’s&lt;/a&gt; are the cheapest ones and will show a green lock in the address bar of the browser.&lt;/p&gt;
&lt;p&gt;It’s also possible to use self-signed certificate. But that will show a red lock with cross in the address bar. Main difference will be the &lt;code&gt;.crt&lt;/code&gt; certificate we are going to use for the server. To configure SSL for an HTTP server we need one &lt;code&gt;.key&lt;/code&gt; and corresponding &lt;code&gt;.crt&lt;/code&gt; file. Details about private keys and csr’s are described &lt;a href=&quot;https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;. To summerize, for self issued certificate, first generate a private key and a &lt;code&gt;.crt&lt;/code&gt; file.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# replace the domain with a name you like&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;openssl req \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -newkey rsa:&lt;span class=&quot;number&quot;&gt;2048&lt;/span&gt; -nodes -keyout domain.key \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -x509 -days &lt;span class=&quot;number&quot;&gt;365&lt;/span&gt; -out ssl.crt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# put the files into proper folder so that GitLab can get them&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo mkdir -p /etc/gitlab/ssl&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo chmod &lt;span class=&quot;number&quot;&gt;700&lt;/span&gt; /etc/gitlab/ssl&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cp domain.key ssl.crt /etc/gitlab/ssl/ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# also add the keys to the system&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cp ssl.crt /etc/ssl/certs/gitlab.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cat /etc/ssl/certs/gitlab.pem &amp;gt; /etc/ssl/certs/ca-certificates.crt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If you’ve bought a SSL certificate from a provider like Comodo, you need one &lt;code&gt;.csr&lt;/code&gt; file to upload to the site to issue a &lt;code&gt;domain validated certificate&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;openssl req \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -newkey rsa:&lt;span class=&quot;number&quot;&gt;2048&lt;/span&gt; -nodes -keyout domain.key \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -out domain.csr&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Upload the &lt;code&gt;.csr&lt;/code&gt; file to the site and after validation/completion of the required steps you can download a &lt;code&gt;.zip&lt;/code&gt; file containing either two files like &lt;code&gt;domain.crt&lt;/code&gt; and  something like &lt;code&gt;domain-bundle.crt&lt;/code&gt; or 4 files, such as &lt;code&gt;domain.crt&lt;/code&gt;, &lt;code&gt;AddTrustExternalCARoot.crt&lt;/code&gt;, &lt;code&gt;COMODORSAAddTrustCA.crt&lt;/code&gt; and &lt;code&gt;COMODORSADomainValidationSecureServerCA.crt&lt;/code&gt;. This is the case of Comodo Positive SSL. If you find it otherwise, please consider your SSL issuer’s document about this.&lt;/p&gt;
&lt;p&gt;Either way, you need to concatenate all the &lt;code&gt;.crt&lt;/code&gt; files into one.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# if you&#39;ve two .crt files&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cat domain.crt domain-bundle.crt &amp;gt; ssl.crt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# if you&#39;ve four different files&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cat domain.crt COMODORSADomainValidationSecureServerCA.crt  COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt &amp;gt; ssl.crt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# put the files into proper folder so that GitLab can get them&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo mkdir -p /etc/gitlab/ssl&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo chmod &lt;span class=&quot;number&quot;&gt;700&lt;/span&gt; /etc/gitlab/ssl&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cp domain.key ssl.crt /etc/gitlab/ssl/ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# also add the keys to the system&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cp ssl.crt /etc/ssl/certs/gitlab.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cat /etc/ssl/certs/gitlab.pem &amp;gt; /etc/ssl/certs/ca-certificates.crt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To configure your server with the domain name you decided, you have to register the domain name and point the domain to the server or you can use sub-domain of an existing domain. For subdomain create just one &lt;a href=&quot;https://en.wikipedia.org/wiki/CNAME_record&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CNAME&lt;/a&gt;. &lt;a href=&quot;https://support.google.com/a/answer/47283?hl=en&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Here&lt;/a&gt; you can find some details. Open the generic steps. Use the name you decided for the subdomain as the alias.&lt;/p&gt;
&lt;p&gt;To use a root domain like &lt;code&gt;domain.tld&lt;/code&gt;, you need to create one A-record and one CNAME record. &lt;a href=&quot;https://support.google.com/a/answer/48090?hl=en&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Here&lt;/a&gt;, you can read about various record types for DNS, &lt;a href=&quot;https://support.cloudflare.com/hc/en-us/articles/200169096-How-do-I-add-A-records-&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt; is one guide to add A-record and &lt;a href=&quot;https://www.digitalocean.com/community/questions/how-to-add-www-record-to-domain&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;, you will get the details regarding how to point your domain to your server. For that you need to know the IP of the server. Either get it from the mail, you got after buying the server or server provider’s control panel or by the following method, if you are logged into your server by ssh.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# icanhazip is a free service for ip lookup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;curl http://icanhazip.com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xx.xx.xx.xx &lt;span class=&quot;comment&quot;&gt;# server ip&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;We are in the last phase of configuration of our GitLab server. Open the file &lt;code&gt;/etc/gitlab/gitlab.rb&lt;/code&gt; and add/modify some lines in it. Replace the &lt;code&gt;domain&lt;/code&gt; carefully.&lt;/p&gt;
&lt;figure class=&quot;highlight ruby&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;external_url &lt;span class=&quot;string&quot;&gt;&quot;https://domain.tld&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nginx[&lt;span class=&quot;string&quot;&gt;&#39;redirect_http_to_https&#39;&lt;/span&gt;] = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nginx[&lt;span class=&quot;string&quot;&gt;&#39;ssl_certificate&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/etc/gitlab/ssl/ssl.crt&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nginx[&lt;span class=&quot;string&quot;&gt;&#39;ssl_certificate_key&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;/etc/gitlab/ssl/domain.key&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nginx[&lt;span class=&quot;string&quot;&gt;&#39;proxy_set_headers&#39;&lt;/span&gt;] = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;X-Forwarded-Proto&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;http&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;CUSTOM_HEADER&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;VALUE&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, execute &lt;code&gt;sudo gitlab-ctl reconfigure&lt;/code&gt;. It’ll take some time, depending on the speed of the server. And, if everything goes ok, we should be able to open GitLab client in the browser at &lt;code&gt;https://domain.tld&lt;/code&gt;, with a green lock of SSL.&lt;/p&gt;
&lt;p&gt;Congratulations!!!&lt;/p&gt;
&lt;p&gt;First the browser will be redirected to set the password of the initial administrator account &lt;code&gt;root&lt;/code&gt;. Set the password and log into the dashboard by entering the username &lt;code&gt;root&lt;/code&gt; and the password you’ve just set. Click on the small range icon to the right hand side of the top bar and then click on the settings icon to left. There you’ll find lot of options to customize. Probably you need to stop the public Sign-up first and use two-factor authentication.&lt;/p&gt;
&lt;p&gt;Your server is set-up. Now we have to configure our CI. This is pretty straight forward.&lt;/p&gt;
&lt;p&gt;Upload the &lt;code&gt;ssl.crt&lt;/code&gt; to the server, intended for the CI. SSH into this server.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get upgrade&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# for those, who have configured with self signed &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# certificate, following steps are required &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /path/to/ssl.crt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cp ssl.crt /etc/ssl/certs/gitlab.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo cat /etc/ssl/certs/gitlab.pem &amp;gt; /etc/ssl/certs/ca-certificates.crt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;First &lt;a href=&quot;https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/blob/master/docs/executors/README.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;decide&lt;/a&gt; about the runner, and follow the &lt;a href=&quot;https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/blob/master/docs/install/linux-repository.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;steps&lt;/a&gt;. There are also some links to important documents &lt;a href=&quot;https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/blob/master/docs/executors/README.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Create a new project. Configure &lt;code&gt;.gitlab-ci.yml&lt;/code&gt; and enjoy build at every push. Don’t forget to add one badge to the &lt;code&gt;README&lt;/code&gt;, will come in the format, &lt;code&gt;![Build Status](https://domain.tld/namespace/project-name/badges/branch-name/build.svg)&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Happy coding. Try to live in your own terms. :-)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Please select &lt;a href=&quot;http://releases.ubuntu.com/16.04/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu 16.04&lt;/a&gt;, if it’s possible, as the serve
    
    </summary>
    
      <category term="CI" scheme="http://coderuse.com/categories/CI/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/CI/Cookbook/"/>
    
      <category term="System" scheme="http://coderuse.com/categories/CI/Cookbook/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/"/>
    
      <category term="Economical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/Economical/"/>
    
    
      <category term="ci" scheme="http://coderuse.com/tags/ci/"/>
    
      <category term="gitlab" scheme="http://coderuse.com/tags/gitlab/"/>
    
      <category term="private-git" scheme="http://coderuse.com/tags/private-git/"/>
    
  </entry>
  
  <entry>
    <title>How I Host Private GitLab With CI For Less Than Four Euro</title>
    <link href="http://coderuse.com/2016/09/How-I-Host-Private-GitLab-With-CI-For-Less-Than-Four-Euro/"/>
    <id>http://coderuse.com/2016/09/How-I-Host-Private-GitLab-With-CI-For-Less-Than-Four-Euro/</id>
    <published>2016-09-16T04:30:34.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;We the creators must take good care of what we create. I, as a software developer write code. A journalist creates new articles. A researcher writes thesis. And so on. These, what we create, does not come without cost. Here the cost is, we have to conceive an idea. Do research on that idea. Collect documents, which have been created by others,on that idea or related to that idea. Read/analyse the collected resources. Think and think over the topic. For days. For months. For some, maybe some years. The creator of Pokemon Go, conceived the idea in 2010. And finally could publish in 2016. It takes time to create. Creation costs ourselves.&lt;/p&gt;
&lt;p&gt;So, we must take good care of what we create. We must preserve them. And we should take it seriously.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This is the first part of a series to configure a source control hosting with some push towards doing it for ourselves&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Second part regarding installing and configuring GitLab community edition server is &lt;a href=&quot;/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Now-a-days everybody is doing data-mining. Big corporations are pioneering this trend. Lot of lawsuits have been filed, is filed on a regular basis. Whatever we do, are persisted and they are analysed by good AI algorithms. Every corporations are &lt;a href=&quot;https://techcrunch.com/2015/12/25/investing-in-artificial-intelligence/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;investing&lt;/a&gt; trillions of dollars for AI. The data-mining are not personally targetted, at-least what they claim. But, &lt;a href=&quot;http://mashable.com/2016/09/14/standard-innovation-vibrator-law-suit&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;no body is stopping them&lt;/a&gt; to do that in the age of aggressive marketing.    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Creation costs ourselves. So, we must keep them on our own terms.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I write code. So, &lt;code&gt;mimetype&lt;/code&gt; of my creation is &lt;code&gt;application/text&lt;/code&gt;, in-simple-words, basically I create text-files. For this kind of documents, any version control systems like &lt;a href=&quot;https://en.wikipedia.org/wiki/Git&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Git&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/Mercurial&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Mercurial&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/GNU_Bazaar&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Bazaar&lt;/a&gt; is enough. I prefer Git, as I have to use it on a daily basis for my job. So, I had opted for premium subscription of Github. They have recently allowed unlimited private repositories and just announced a &lt;a href=&quot;https://github.com/blog/2256-a-whole-new-github-universe-announcing-new-tools-forums-and-features&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;large bouque&lt;/a&gt; of features, to help developers. But, it offended me and &lt;a href=&quot;https://wptavern.com/github-introduces-unlimited-private-repositories-hikes-prices-for-organizations&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;lot of others&lt;/a&gt;, when Github &lt;a href=&quot;https://github.com/blog/2164-introducing-unlimited-private-repositories&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;increased their price&lt;/a&gt; for organisations. I don’t manage any organisation, but I realized that we are so helpless before the &lt;em&gt;strategical decisions aka whims&lt;/em&gt; of the big corporations. They can do anything to us as we have agreed their terms, when signed up for the services. Do you read the terms? I don’t, rather can’t. I find them like a spiraling web of stairs, steps made of jargons from the &lt;em&gt;world of law&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;We can’t go absolutely beyond the reach of the big corporations. But at-least we can try to take some steps towards making our life &lt;em&gt;private&lt;/em&gt; and live &lt;em&gt;on our own terms&lt;/em&gt;. :-)&lt;/p&gt;
&lt;p&gt;On this note, let’s configure a private instance of Git Server. But maintaining a Git server and other companion tools such as source code browser, decent web interface to manage the server, we also need a issue tracker, projects need wiki’s and of-cource user management of such a server is not a matter of joke. We need a good packaged software such as Bitbucket Server or GitLab, which offer all such features. Bitbucket is quite pricey, if team size grows beyond 10. Also we have to maintain a VPS, that itself incur a recurring cost, we don’t want to spend on Server Software. So, we choose GitLab Community Edition. It’s free. Though it &lt;a href=&quot;https://about.gitlab.com/features/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;lacks some features&lt;/a&gt; of the pro edition, available ones are enough for small organisations.&lt;/p&gt;
&lt;p&gt;In this series I’m going to write step-by-step process to configure GitLab Community Edition server along with adding support for SSL.&lt;/p&gt;
&lt;p&gt;This is going to be long. So, buckle up.&lt;/p&gt;
&lt;p&gt;But before we start the installation, we must get a server to host. Now, here I’ve some words to say. As we have to preserve something, whatever it may be, it should not be like that, all our saved assets be lost, if the server crashes. So, we have to take backups at regular interval, may be every day. And along with that, we should prefer cloud servers as they are more stable than dedicated ones. Actually cloud servers are made as an abstraction of the actual hardware. So, even if one or two physical units from a cloud cluster crashes, the servers, built upon them takes another computational units as failover.&lt;/p&gt;
&lt;p&gt;When we host/run GitLab, a bunch of services run simultaneously. &lt;a href=&quot;http://redis.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Redis&lt;/a&gt;, &lt;a href=&quot;https://www.postgresql.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PostgreSQL&lt;/a&gt;, &lt;a href=&quot;https://www.nginx.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Nginx&lt;/a&gt;, Workhorse (a background process), &lt;a href=&quot;http://sidekiq.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sidekiq&lt;/a&gt;, &lt;a href=&quot;http://unicorn.bogomips.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Unicorn&lt;/a&gt;, &lt;a href=&quot;https://docs.gitlab.com/omnibus/settings/logs.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;LogRotate&lt;/a&gt;. So, we need at least 2 cores and at-least 2GB memory, so that server does not get too much slow or unresponsive. &lt;a href=&quot;https://gitlab.cern.ch/help/install/requirements.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More details&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For cloud servers there are many options, &lt;a href=&quot;https://www.digitalocean.com/pricing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;DigitalOcean&lt;/a&gt;, &lt;a href=&quot;https://www.vultr.com/pricing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vultr&lt;/a&gt;, &lt;a href=&quot;https://www.linode.com/pricing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linode&lt;/a&gt;, &lt;a href=&quot;https://aws.amazon.com/ec2/pricing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AWS&lt;/a&gt;, &lt;a href=&quot;https://cloud.google.com/compute/pricing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Google Cloud&lt;/a&gt;, &lt;a href=&quot;https://azure.microsoft.com/en-us/pricing/details/virtual-machines/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Microsoft Azure&lt;/a&gt;, and so many others. Personally I use &lt;a href=&quot;https://www.scaleway.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Scaleway&lt;/a&gt;, a brand from &lt;a href=&quot;https://www.online.net/en&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Online.net&lt;/a&gt; to host the GitLab server. There I got one cloud server (they use &lt;a href=&quot;https://www.scaleway.com/faq/server/#-Which-hypervisor-do-you-use&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;KVM&lt;/a&gt;) with 2 cores, 2GB primary memory aka RAM and 50GB SSD hard disk at €2.99/pm. And for CI, I use lowest offerring from &lt;a href=&quot;https://www.arubacloud.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Aruba Cloud&lt;/a&gt;, a small vps with 1 core, 1GB RAM and 20GB SSD for €1/pm. You can also check for low cost KVM servers in UK from &lt;a href=&quot;http://www.rackulous.com/uk-kvm-vps.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Rackulous&lt;/a&gt; or checkout low cost offers, regularly published in &lt;a href=&quot;https://lowendbox.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;lowendbox&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Hence, it’s concluded that, it’s possible to host GitLab Community Edition Server with CI for €3.99/pm, less than €4/pm. :-)&lt;/p&gt;
&lt;p&gt;If you have selected and got your VPS, we can go for the next step. &lt;a href=&quot;/2016/09/Installation-And-Configuration-Of-GitLab-Server-With-CI/&quot;&gt;Install and configure GitLab server&lt;/a&gt;. :-)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;We the creators must take good care of what we create. I, as a software developer write code. A journalist creates new articles. A resear
    
    </summary>
    
      <category term="CI" scheme="http://coderuse.com/categories/CI/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/CI/Cookbook/"/>
    
      <category term="System" scheme="http://coderuse.com/categories/CI/Cookbook/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/"/>
    
      <category term="Economical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/Economical/"/>
    
    
      <category term="ci" scheme="http://coderuse.com/tags/ci/"/>
    
      <category term="gitlab" scheme="http://coderuse.com/tags/gitlab/"/>
    
      <category term="private-git" scheme="http://coderuse.com/tags/private-git/"/>
    
  </entry>
  
  <entry>
    <title>CI with Vexor</title>
    <link href="http://coderuse.com/2016/09/CI-with-Vexor/"/>
    <id>http://coderuse.com/2016/09/CI-with-Vexor/</id>
    <published>2016-09-10T19:34:51.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Today I’ve configured CI with &lt;a href=&quot;https://vexor.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vexor&lt;/a&gt; for this blog. Actually I use &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt; to generate a static site and then upload the generated static content to the remote machine, hosting the blog. Quite simple.&lt;/p&gt;
&lt;p&gt;Generating the static pages and then upload them to the remote machine takes a lot of effort beside writing a post. And the job is so repetitive. So, CI is a very good use case for this. But, as I use private repo for this, most of the prominent CI hosts charge a lot to build for private repos. After searching a little bit, got the name of &lt;a href=&quot;https://vexor.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vexor&lt;/a&gt;. The best thing is that, they are not limiting you, 1 build unit, 2 build units, private repo etc. You start with free 100 build minutes, then $0.015/min. Quite cheap. And no prior commitment with huge monthly subscriptions (Others are really pricey. I don’t understand, why do they charge over $30/month for a single unit, while builds for most of the normal projects does not go over 1hr. And how many builds per day a project can see. I don’t know.) So, I pleased with the pricing matrix of &lt;a href=&quot;https://vexor.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vexor&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; Probably Vexor recently has updated their pricing policy. At least they sent mails to it’s users that, there would be no free build minutes. Builds will be invoiced at a rate of $0.015/min, but there is no change in the pricing plans on their website. Please check with the support before creating an account.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;One problem with them is they have not yet completed their documentation fully. And their whole doc is full of examples of building Ruby applications. Probably they are fond of Ruby. I’ve no complains. But they should include at-least some full examples for NodeJS. Then I came across one of the features in their build system. You can log into the build container for 30 mins (if you enable ssh) to debug. So, nice feature. Probably use only once for one project but that’s big.&lt;/p&gt;
&lt;p&gt;So, I started to configure. First steps are quite straight-forward. Go to &lt;a href=&quot;https://vexor.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vexor&lt;/a&gt;. Sign up with Github or GitLab or Bitbucket account. Enable your repo. You should be able to see the repo in your &lt;a href=&quot;https://ci.vexor.io/ui/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dashboard&lt;/a&gt;. As soon as the repo is connected, it will try to start the build. But, my repo was not configured. Naturally, first build failed. Then I started to configure.&lt;/p&gt;
&lt;p&gt;First, added one file to the root of the repo by the name &lt;code&gt;.vexor.yml&lt;/code&gt; (&lt;code&gt;vexor.yml&lt;/code&gt;, without the leading dot is also permissible).&lt;/p&gt;
&lt;p&gt;As I want to build for NodeJS. I added &lt;code&gt;language: node_js&lt;/code&gt;. They have support for several versions of Node. I added for &lt;code&gt;6.1.0&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;language: node_js&amp;#10;node_js:&amp;#10;- &amp;#34;6.1.0&amp;#34;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;I use &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt; to generate the site. And this needs &lt;code&gt;hexo-cli&lt;/code&gt; to be installed globally. So, I added &lt;code&gt;npm install -g hexo-cli&lt;/code&gt; and of-course &lt;code&gt;npm install&lt;/code&gt; to the &lt;code&gt;install&lt;/code&gt; section.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;install:&amp;#10;- npm install -g hexo-cli&amp;#10;- npm install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;As I’ve included one post-install hook to the &lt;code&gt;package.json&lt;/code&gt; with the command &lt;code&gt;hexo generate&lt;/code&gt;, practically I’ve nothing to do for generation of static content in the &lt;code&gt;script&lt;/code&gt; section.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &quot;scripts&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;postinstall&quot;: &quot;hexo generate&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, I need to upload the generated content to the remote site. So, added some lines (with the help of &lt;a href=&quot;https://gist.github.com/domenic/ec8b0fc8ab45f39403dd&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Domenic&lt;/a&gt;) to the &lt;code&gt;before_script&lt;/code&gt; section to add the &lt;code&gt;ssh-key&lt;/code&gt; to &lt;code&gt;ssh agent&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;before_script:&amp;#10;- chmod 600 /home/vexor/.ssh/id_rsa&amp;#10;- eval `ssh-agent -s`&amp;#10;- ssh-add /home/vexor/.ssh/id_rsa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The available key in the &lt;code&gt;.ssh&lt;/code&gt; is the private key you have to add in the settings of the project. You can generate one key pair by &lt;code&gt;ssh-keygen -t rsa -b 4096 -C &amp;quot;your_email@example.com&amp;quot;&lt;/code&gt;. &lt;a href=&quot;https://help.github.com/articles/generating-an-ssh-key/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More detail&lt;/a&gt;. And add the content of the public key of the pair to a file named &lt;code&gt;authorized_keys&lt;/code&gt; in the &lt;code&gt;.ssh&lt;/code&gt; directory of &lt;code&gt;home&lt;/code&gt; of the user, you want to deploy with, to the remote machine.&lt;/p&gt;
&lt;p&gt;To deploy I’ve added one shell script file, named &lt;code&gt;deploy&lt;/code&gt; in my repo. (taken from &lt;a href=&quot;https://coderwall.com/p/moabdw/using-rsync-to-deploy-a-website-easy-one-liner-command&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;). Only I modified the &lt;code&gt;userid&lt;/code&gt;, &lt;code&gt;server address&lt;/code&gt;, added &lt;code&gt;cd public&lt;/code&gt; (from where we need to upload), the remote directory path and removed the &lt;code&gt;exclude-from&lt;/code&gt; flag.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;shebang&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; public&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ERRORSTRING&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Error. Please make sure you&#39;ve indicated correct parameters&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;variable&quot;&gt;$#&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$ERRORSTRING&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;elif&lt;/span&gt; [ &lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt; == &lt;span class=&quot;string&quot;&gt;&quot;live&quot;&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [[ -z &lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt; ]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Running dry-run&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                rsync --dry-run -az --force --delete --progress &lt;span class=&quot;operator&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;ssh -p22&quot;&lt;/span&gt; ./ build@xx.xx.xx.xx:/usr/share/nginx/html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;elif&lt;/span&gt; [ &lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt; == &lt;span class=&quot;string&quot;&gt;&quot;go&quot;&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Running actual deploy&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                rsync -az --force --delete --progress &lt;span class=&quot;operator&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;ssh -p22&quot;&lt;/span&gt; ./ build@xx.xx.xx.xx:/usr/share/nginx/html&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$ERRORSTRING&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;This file &lt;code&gt;deploy&lt;/code&gt; need to executable. So, added &lt;code&gt;chmod +x ./deploy&lt;/code&gt; to the &lt;code&gt;before_script&lt;/code&gt; section.&lt;/p&gt;
&lt;p&gt;And finally in the &lt;code&gt;script&lt;/code&gt; section added &lt;code&gt;./deploy live go&lt;/code&gt;, which will deploy the generated content to the remote directory, if all things go successfully.&lt;/p&gt;
&lt;p&gt;If anyone needs the full glimpse of &lt;code&gt;.vexor.yml&lt;/code&gt;, here it is,&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;language: node_js&amp;#10;node_js:&amp;#10;- &amp;#34;6.1.0&amp;#34;&amp;#10;install:&amp;#10;- npm install -g hexo-cli&amp;#10;- npm install&amp;#10;before_script:&amp;#10;- chmod 600 /home/vexor/.ssh/id_rsa&amp;#10;- eval `ssh-agent -s`&amp;#10;- ssh-add /home/vexor/.ssh/id_rsa&amp;#10;- chmod +x ./deploy&amp;#10;script: ./deploy live go&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      Vexor is a CI tool/website, where we can host our CI builds. In this post I&#39;ve examined how to configure Vexor in order to host our CI builds.
    
    </summary>
    
      <category term="CI" scheme="http://coderuse.com/categories/CI/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/CI/Cookbook/"/>
    
      <category term="System" scheme="http://coderuse.com/categories/CI/Cookbook/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/CI/Cookbook/System/Technical/"/>
    
    
      <category term="ci" scheme="http://coderuse.com/tags/ci/"/>
    
      <category term="nodejs" scheme="http://coderuse.com/tags/nodejs/"/>
    
      <category term="vexor" scheme="http://coderuse.com/tags/vexor/"/>
    
  </entry>
  
  <entry>
    <title>Moving new Git branch with different history to master</title>
    <link href="http://coderuse.com/2016/08/Moving-new-Git-branch-with-different-history-to-master/"/>
    <id>http://coderuse.com/2016/08/Moving-new-Git-branch-with-different-history-to-master/</id>
    <published>2016-08-22T10:42:04.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Today I’ve learned a new thing about Git. Actually some days back, we started re-implementation of one of our old web app. Previously, the app was written with Jquery. Some days back, we felt that, it would be better, if we could use ReactJs for the app, as it only shows updates, and each of the updates has it’s own life cycle. So, thought this would be a good use case to leverage the powerful features of ReactJs.&lt;/p&gt;
&lt;p&gt;Anyway, as this new development happens to be completely different than the previous one, first decided to create a new repository altogether. But, after some considerations, came to the conclusion, that it would be wrong, if we create a completely new repository for a software, that will do essentially the same things as the previous one.&lt;/p&gt;
&lt;p&gt;So, created one orphan branch from master.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git checkout master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git checkout -b --orphan new_version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git rm &amp;lt;all-the-unnecessary-files&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## Make changes in the code base&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git add .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git commit -am &lt;span class=&quot;string&quot;&gt;&quot;new_version: Initialize&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Generally the remote is &#39;origin&#39;, if not change as required&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push origin new_version&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And continued development on that.&lt;/p&gt;
&lt;p&gt;Until this stage, there was no problem. But, problem started, when we tried to push this branch to master. We could not merge this branch to master, as that would nullify the effort to make a new commit history for the new version.&lt;/p&gt;
&lt;p&gt;Decided to delete the master branch and create new master branch from &lt;code&gt;new_version&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Create a backup of the old version&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git checkout master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git checkout -b old_version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# And push the backup to remote&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push origin old_version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# &#39;-D&#39; is needed instead of &#39;-d&#39;, as current branch &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# and &#39;master&#39; branch has different commit history&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;##### Following error will come&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# error: The branch &#39;master&#39; is not fully merged.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# If you are sure you want to delete it, run &#39;git branch -D master&#39;.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git branch -D master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, we can’t delete the master branch from remote straight away. It would give the following error.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;To git@github.com:username/repo.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ! [remote rejected] master (refusing to delete the current branch: refs/heads/master)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;error: failed to push some refs to &lt;span class=&quot;string&quot;&gt;&#39;git@github.com:username/repo.git&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;As our repository is hosted in Github, we could change the default branch temporarily to &lt;code&gt;new_version&lt;/code&gt; in the branches tab of settings page of the repository. And delete the &lt;code&gt;master&lt;/code&gt; branch in &lt;code&gt;remote&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git push origin :master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# To git@github.com:username/repo.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#  - [deleted]         master&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, create the new &lt;code&gt;master&lt;/code&gt; branch from &lt;code&gt;new_version&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git checkout new_version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git checkout -b master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# And check-in this new master branch&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push origin master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, change the &lt;code&gt;default&lt;/code&gt; branch to &lt;code&gt;master&lt;/code&gt; in Github.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Today I’ve learned a new thing about Git. Actually some days back, we started re-implementation of one of our old web app. Previously, th
    
    </summary>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/Cookbook/"/>
    
      <category term="Programming" scheme="http://coderuse.com/categories/Cookbook/Programming/"/>
    
      <category term="Software Development" scheme="http://coderuse.com/categories/Cookbook/Programming/Software-Development/"/>
    
    
      <category term="branch" scheme="http://coderuse.com/tags/branch/"/>
    
      <category term="git" scheme="http://coderuse.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Show modal dialog in IE with IFrame</title>
    <link href="http://coderuse.com/2016/04/Show-modal-dialog-in-IE-with-IFrame/"/>
    <id>http://coderuse.com/2016/04/Show-modal-dialog-in-IE-with-IFrame/</id>
    <published>2016-04-27T21:12:04.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;We had used modal dialog of IE, in one of our old projects. What we did there, opened one modal dialog, with one url to a external website. In the external page (not maintained by us), one variable &lt;code&gt;returnValue&lt;/code&gt; was set to &lt;code&gt;window&lt;/code&gt; with the intended value (one object actually), and we used to get the resultant from the return value of &lt;code&gt;showModalDialog&lt;/code&gt;, as this returns the value present in &lt;code&gt;window.returnValue&lt;/code&gt; of the modal.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Here is the bare minimum code of the markup creating the modal.&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- index.html --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;doctype&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;lang&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;charset&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Show Modal Test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;disabled&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;button1&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;onclick&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;openWindows()&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;Enter Name&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;openWindows&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;// Get the return value set by the modal window&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; getval = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.showModalDialog(&lt;span class=&quot;string&quot;&gt;&#39;modal.html&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.document.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;).value = getval.data;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And this is the markup of the modal (maintained by third party). The &lt;code&gt;returnValue&lt;/code&gt; property in the &lt;code&gt;window&lt;/code&gt; object of &lt;code&gt;modal&lt;/code&gt;, is returned by the &lt;code&gt;showModalDialog&lt;/code&gt; method.&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- modal.html --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;doctype&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;lang&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;charset&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Modal Window&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;inputName&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;btnReturnValues&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;onclick&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;ReturnValues()&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Submit&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReturnValues&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; vReturnValue = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;inputName&#39;&lt;/span&gt;).value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.returnValue = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          data: vReturnValue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;After some time, due to some sizing issue of the modal dialog, we used one intermediary HTML page as the content of the modal. And, in that page we navigated to the external link, via an IFrame, setting the dimention. So, we added the url of the container (where the IFrame resides) as the first parameter of the method &lt;code&gt;showModalDialog&lt;/code&gt; and sending the url of the intended url as &lt;code&gt;dialogArguments&lt;/code&gt; (&lt;a href=&quot;https://goo.gl/a3lcwG&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;refer to&lt;/a&gt;).&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; getval = w.showModalDialog(&lt;span class=&quot;string&quot;&gt;&#39;container.html&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;modal.html&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;dialogWidth:960px; dialogHeight: 670px; resizable: yes&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And added the container page. Modifications were not required in the third party page.&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- container.html --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;doctype&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Conatiner&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;onload&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;setStyle()&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;iframeExternalLink&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;iframeExternalLink&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;iframe&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.onload = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; url = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.dialogArguments;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;iframeExternalLink&#39;&lt;/span&gt;).src = url;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Explicitly setting the height of the IFrame. Even if the third-party page comes bogger, scroll bars will come&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setStyle&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;iframeExternalLink&#39;&lt;/span&gt;).height = &lt;span class=&quot;string&quot;&gt;&#39;670px&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;iframeExternalLink&#39;&lt;/span&gt;).width = &lt;span class=&quot;string&quot;&gt;&#39;960px&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;That was working fine, till last week. After one patch (Current version: IE11-11.0.9600.18204, IE10-10.0.9200.17640), the procedure is not working as previous. If we examine closely, this should not work previously also. As from the external web page, the &lt;code&gt;returnValue&lt;/code&gt; property is set in the &lt;code&gt;window&lt;/code&gt;, that property is set theoretically to the &lt;code&gt;window&lt;/code&gt; object of the IFrame itself. But somehow it was working.&lt;/p&gt;
&lt;p&gt;As we are opening third party url, it’s a long procedure, to tell them to change in their code. So, we were searching for a solution, so that, third party code should not needed to be affected.&lt;/p&gt;
&lt;p&gt;After some brainstorming, we thought that, in the &lt;code&gt;onbeforeunload&lt;/code&gt; event (called before closing of a window), in the &lt;code&gt;container.html&lt;/code&gt;, we can set the &lt;code&gt;returnValue&lt;/code&gt; property in the &lt;code&gt;window&lt;/code&gt; object of the page, where the IFrame resides.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.onbeforeunload = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; win = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.frames[&lt;span class=&quot;string&quot;&gt;&#39;iframeExternalLink&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.returnValue = win.returnValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;This was working. But, that again didn’t work. As, the third party website is using Telerik, the library sets the &lt;code&gt;onbeforeunload&lt;/code&gt; as it requires. So, our event handler is at all not fired.&lt;/p&gt;
&lt;p&gt;What to do now?&lt;/p&gt;
&lt;p&gt;We found our second approach. But this approach requires modification in the third party code. In the function, where the &lt;code&gt;window.close&lt;/code&gt; is called, they need to call one method &lt;code&gt;setReturnValue&lt;/code&gt; of &lt;code&gt;parent&lt;/code&gt;, which in turn will set the &lt;code&gt;returnValue&lt;/code&gt; in the parent (the modal window) or directly set the value of the property &lt;code&gt;returnValue&lt;/code&gt; in &lt;code&gt;window.parent&lt;/code&gt;.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;!-- In container.html --&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setReturnValue&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;returnVal&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.returnValue = returnVal;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;and in the external web page: &lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// In modal.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReturnValues&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; vReturnValue = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;inputName&#39;&lt;/span&gt;).value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// Call the method in parent to set the returnValue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.parent.setReturnValue( &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    data: vReturnValue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;or in short,&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// In modal.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.parent.returnValue = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data: vReturnValue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;This would solve the problem. Easy solution. Right?&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;We had used modal dialog of IE, in one of our old projects. What we did there, opened one modal dialog, with one url to a external website. In the external page (not maintained by us), one variable &lt;code&gt;returnValue&lt;/code&gt; was set to &lt;code&gt;window&lt;/code&gt; with the intended value (one object actually), and we used to get the resultant from the return value of &lt;code&gt;showModalDialog&lt;/code&gt;, as this returns the value present in &lt;code&gt;window.returnValue&lt;/code&gt; of the modal.&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/JavaScript/"/>
    
      <category term="IE" scheme="http://coderuse.com/categories/JavaScript/IE/"/>
    
      <category term="IFrame" scheme="http://coderuse.com/categories/JavaScript/IE/IFrame/"/>
    
      <category term="Interesting" scheme="http://coderuse.com/categories/JavaScript/IE/IFrame/Interesting/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/JavaScript/IE/IFrame/Interesting/Cookbook/"/>
    
    
      <category term="IE" scheme="http://coderuse.com/tags/IE/"/>
    
      <category term="IFrame" scheme="http://coderuse.com/tags/IFrame/"/>
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
      <category term="modal" scheme="http://coderuse.com/tags/modal/"/>
    
      <category term="returnValue" scheme="http://coderuse.com/tags/returnValue/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript &#39;bind&#39;: a less used magic</title>
    <link href="http://coderuse.com/2016/04/JavaScript-bind-a-less-used-magic/"/>
    <id>http://coderuse.com/2016/04/JavaScript-bind-a-less-used-magic/</id>
    <published>2016-04-22T05:45:33.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;There is a method &lt;a href=&quot;https://goo.gl/nNOcH3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;bind&lt;/a&gt; available in &lt;code&gt;function.prototype&lt;/code&gt; of JavaScript. Do you know? May be.&lt;/p&gt;
&lt;p&gt;I got to know about this in detail at quite a later time in my programming carrier. I heard and read about the method. But couldn’t find good example/use-case to use. Recently one of my colleagues came with a puzzle question, how to write this &lt;code&gt;multiply&lt;/code&gt; function so that the following would return &lt;code&gt;120&lt;/code&gt; the product of the numbers passed.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;multiply(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;He showed the solution as following:&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;multiply&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;a&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;b&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;c&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;d&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a * b * c * d * e;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;But, somehow I didn’t like the solution. As we can multiply that many numbers equal to the number of funcitons returned in chained fashion. And thought that partial function can be a resort to solve this problem. So my solution was:&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;pi&quot;&gt;&#39;use strict&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// In non-strict mode we have to use this !== window (vide: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; multiply = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;a, b&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!b &amp;amp;&amp;amp; (&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt; !== &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; multiply.bind(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, !b? a: a * b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;But here we only have to call this as &lt;code&gt;multiply(2)(3)(4)(5)(6)(7)()&lt;/code&gt;, with an extra parenthesis to call the last generated function. Also, we have to be careful about the sentinel constraint as described in the comment.&lt;/p&gt;
&lt;p&gt;Until the last call of the method, it actually returns partial functions. And for the first and last case, we are relying on the fact, that &lt;code&gt;this&lt;/code&gt; would be &lt;code&gt;undefined&lt;/code&gt; in the first case and in the last call (the sentinel call), &lt;code&gt;b&lt;/code&gt; would be &lt;code&gt;undefined&lt;/code&gt; as well as &lt;code&gt;this&lt;/code&gt; would be &lt;code&gt;null&lt;/code&gt; not &lt;code&gt;undefined&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;It’s a good use-case to use &lt;code&gt;bind&lt;/code&gt;. And with this implementation we are not restricting ourselves to the number of operands, can be passed.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;There is a method &lt;a href=&quot;https://goo.gl/nNOcH3&quot;&gt;bind&lt;/a&gt; available in &lt;code&gt;function.prototype&lt;/code&gt; of JavaScript. Do you know? May be.&lt;/p&gt;
&lt;p&gt;I got to know about this in detail at quite a later time in my programming carrier. I heard and read about the method. But couldn’t find good example/use-case to use. Recently one of my colleagues came with a puzzle question, how to write this &lt;code&gt;multiply&lt;/code&gt; function so that the following would return &lt;code&gt;120&lt;/code&gt; the product of the numbers passed.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;multiply(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/JavaScript/"/>
    
      <category term="Puzzle" scheme="http://coderuse.com/categories/JavaScript/Puzzle/"/>
    
      <category term="Interesting" scheme="http://coderuse.com/categories/JavaScript/Puzzle/Interesting/"/>
    
      <category term="Programming Language" scheme="http://coderuse.com/categories/JavaScript/Puzzle/Interesting/Programming-Language/"/>
    
    
      <category term="bind" scheme="http://coderuse.com/tags/bind/"/>
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
      <category term="partial-function" scheme="http://coderuse.com/tags/partial-function/"/>
    
      <category term="return" scheme="http://coderuse.com/tags/return/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript: What is the type of &#39;return&#39;</title>
    <link href="http://coderuse.com/2016/04/JavaScript-What-is-the-type-of-return/"/>
    <id>http://coderuse.com/2016/04/JavaScript-What-is-the-type-of-return/</id>
    <published>2016-04-20T21:43:02.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;When we think of the &lt;code&gt;return&lt;/code&gt; type, we think of the type of data, returned by the concerned function in JavaScript.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;welcome&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Welcome!!!&quot;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;/// Return type is &#39;String&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;But, sometimes back came accross an example of a function.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;add&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;a, b&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a + b),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a + b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(add(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;What would be the output???&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Amazing. Right. Or you’re not amazed, buffled, taken-aback, surprised as I was. May be you know why this is happenning. May be you know about &lt;a href=&quot;https://goo.gl/NjllgA&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;grouping operator&lt;/a&gt;, &lt;a href=&quot;https://goo.gl/4ZpkIk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;comma operator&lt;/a&gt; or you may have already read the ECMA specification for  &lt;a href=&quot;http://goo.gl/Nw1zn6&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;return&lt;/a&gt; and &lt;a href=&quot;http://goo.gl/xDMl8o&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;function&lt;/a&gt;. If neither any of these is your case, read on.&lt;/p&gt;
&lt;p&gt;I posted one question in &lt;a href=&quot;http://goo.gl/qSGdI4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;StackOverflow&lt;/a&gt; regarding this. Many programmers answered and participated in the discussion. Actually if all of the concepts liknked in the above para is clear to one, there should not arise any question. But, it’s me. Never read properly. :P&lt;/p&gt;
&lt;p&gt;The question was, &lt;em&gt;is &lt;code&gt;return&lt;/code&gt; here is behaving like a function&lt;/em&gt;, as we are kind of passing arguments into it.&lt;/p&gt;
&lt;p&gt;Answer: &lt;strong&gt;No&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If we try to print the &lt;code&gt;typeof return&lt;/code&gt; it gives &lt;code&gt;SyntaxError: Unexpected token return&lt;/code&gt;. As &lt;code&gt;return&lt;/code&gt; is a statement by specification and &lt;code&gt;typeof&lt;/code&gt; expects identifier after it, JavaScript engine won’t evaluate the expression. So, what happens here.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The comma operator evaluates each of its operands (from left to right)&lt;/li&gt;
&lt;li&gt;The grouping operator () controls the precedence of evaluation in expressions.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The comma operator makes the evaluation of each of the expressions passed to the grouping opeartor. So, we get the first two lines of the output.&lt;/p&gt;
&lt;p&gt;And the grouping operator is responsible to return the evaluated value of the last expression, separated by &lt;code&gt;comma&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Quite simple. Right. &lt;img src=&quot;/images/emojis/smiley.png&quot; width=&quot;32&quot; height=&quot;32&quot; class=&quot; emoji nofancybox&quot; title=&quot;smiley&quot;&gt; &lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;When we think of the &lt;code&gt;return&lt;/code&gt; type, we think of the type of data, returned by the concerned function in JavaScript.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;welcome&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Welcome!!!&quot;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;/// Return type is &#39;String&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;But, sometimes back came accross an example of a function.&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;add&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;a, b&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a + b),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a + b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(add(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;What would be the output???&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/JavaScript/"/>
    
      <category term="Inner Concepts" scheme="http://coderuse.com/categories/JavaScript/Inner-Concepts/"/>
    
      <category term="Programming Language" scheme="http://coderuse.com/categories/JavaScript/Inner-Concepts/Programming-Language/"/>
    
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
      <category term="return" scheme="http://coderuse.com/tags/return/"/>
    
      <category term="typeof" scheme="http://coderuse.com/tags/typeof/"/>
    
  </entry>
  
  <entry>
    <title>Security Concerns To Build One AngularJS App</title>
    <link href="http://coderuse.com/2016/03/Security-Concerns-To-Build-One-AngularJS-App/"/>
    <id>http://coderuse.com/2016/03/Security-Concerns-To-Build-One-AngularJS-App/</id>
    <published>2016-03-02T00:19:56.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;An AngularJS web app finally results in a Single Page Web Application, managing it’s own routes, states (models), incorporating workflows, CRUD operations and much more around some tasks. So, primarily we have to concentrate on the common flaws found in an web app and then figure out what kind of direct or derived vulnerability may be caused in our app. &lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Network_Eavesdropping&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Eavesdropping&lt;/a&gt;:&lt;/strong&gt; It actually happens in network layer. It has nothing to do with the coding done in the app.&lt;br&gt;&lt;strong&gt;Solution&lt;/strong&gt;: If there is no direct communication between users via the app, it’s a standard to deliver the app over SSL. But solution for this kind of attack is a combination of configurations starting from DNS setting to but not limited to use of HTTPS. (&lt;a href=&quot;https://en.wikipedia.org/wiki/Eavesdropping#See_also&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;See also&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.cert.org/historical/advisories/CA-2000-02.cfm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cross Site Scripting(XSS)&lt;/a&gt;:&lt;/strong&gt; This is where an attacker can inject scripts into a page sent by the server and browser treats the injected script as any other scripts inside the page.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cross Site Request Forgery(CSRF)&lt;/a&gt;:&lt;/strong&gt; A Cross-site request forgery is when a malicious site can use a visitor’s browser to make a request to your server that causes a change on the server. The server thinks that because the request comes with the user’s cookies, the user wanted to submit that form. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Cross-Site-Scripting-XSS&quot;&gt;&lt;a href=&quot;#Cross-Site-Scripting-XSS&quot; class=&quot;headerlink&quot; title=&quot;Cross Site Scripting(XSS)&quot;&gt;&lt;/a&gt;Cross Site Scripting(XSS)&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Use Case:&lt;/strong&gt; Showing menu based on privileges. Users with malicious mind-set can change some of the variables, such that, non privileged members can also see the higher privileged tabs.&lt;br&gt;&lt;strong&gt;Solution:&lt;/strong&gt; Send or build the template, so it would only generate what is required. Nothing more. Ng-repeat may be a good resort here.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Use Case:&lt;/strong&gt; Generation of some part of the page, depending on user input. One may input HTML to change the behaviour of the section.&lt;br&gt;&lt;strong&gt;Solution:&lt;/strong&gt; Treat the user input as strings and do not bind the user input as ng-bind-html&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Use Case:&lt;/strong&gt; User may input some code as the query parameters like: &lt;code&gt;http://abc.com?&amp;lt;script&amp;gt;alert(5)&amp;lt;/script&amp;gt; returns &amp;quot;&amp;lt;p&amp;gt;There were no hits for &amp;lt;script&amp;gt;alert(5)&amp;lt;/script&amp;gt;.&amp;lt;/p&amp;gt;&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt; Use route parameters instead of query parameters. If it’s inevitable to use the query params, do not run eval on the string, use it as a string and of course check for the tags.&lt;/p&gt;
&lt;p&gt;Lastly,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Set correct mime type of the content, exchanged to-and-forth client and server &lt;/li&gt;
&lt;li&gt;If html templates are compiled into templateCache, correctly obfuscate the HTML replacing tags with HTML codes like, &lt;code&gt;&amp;lt;&lt;/code&gt; should be replaced by &lt;code&gt;&amp;amp;lt;&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;It’s more than necessary to obfuscate JavaScript code with minifiers like Closure, YUI-Compressor etc. Signing tools may also be used, to check the page hash in server &lt;/li&gt;
&lt;li&gt;Depending upon the sensitivity of data, passing to the server, it may be required to encrypt the same &lt;/li&gt;
&lt;li&gt;Put each of the piece of the code into a closure, viz. an IIFE and if possible put ‘use strict’ at the top of each of them &lt;/li&gt;
&lt;li&gt;Use dependency injection into every providers. Life would be easy after minification &lt;/li&gt;
&lt;li&gt;If non obfuscated code needs to be used in client side, make the identifier names, as neutral possible. Use ‘re4ty_ft’ instead of ‘carPrice’ &lt;/li&gt;
&lt;li&gt;Disable autocomplete in sensitive information fields. User may have to key-in (even can’t paste. Refer to CITI Bank’s login page) or press keys in a virtual keyboard &lt;/li&gt;
&lt;li&gt;It’s not advisable to put any files containing user-restricted-data in the webroot &lt;/li&gt;
&lt;li&gt;Don’t store information in a global variable &lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Cross-Site-Request-Forgery-CSRF&quot;&gt;&lt;a href=&quot;#Cross-Site-Request-Forgery-CSRF&quot; class=&quot;headerlink&quot; title=&quot;Cross Site Request Forgery(CSRF)&quot;&gt;&lt;/a&gt;Cross Site Request Forgery(CSRF)&lt;/h3&gt;&lt;p&gt; This form of attack includes but not limited to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Access cookie to change &lt;a href=&quot;http://www.squarefree.com/2003/10/23/another-google-security-hole/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;preferences&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Logout the victim &lt;/li&gt;
&lt;li&gt;Post a comment on behalf of the victim &lt;/li&gt;
&lt;li&gt;Use victim as a proxy to get data from the site &lt;/li&gt;
&lt;li&gt;Perform distributed password guessing attack, without even a pass hacker tool&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Send a login hash along with a API key each time client calls the server&lt;/li&gt;
&lt;li&gt;Logout must be done, jointly by client and server, in both ways &lt;/li&gt;
&lt;li&gt;Best not to use a cookie &lt;/li&gt;
&lt;li&gt;For login and sensitive operations, use captcha, or two-factor-authentication apps like DUO &lt;/li&gt;
&lt;li&gt;It’s better to use two different (.aspx or .php whatever) pages for login and app&lt;/li&gt;
&lt;li&gt;No state should be persisted in the server, I.e. to say the REST API should implement a complete REST architecture &lt;/li&gt;
&lt;li&gt;Encourage the users to close the window after logout (Currently Google Chrome does not close the tab/window invoking window.close command) &lt;/li&gt;
&lt;li&gt;Make one landing page and from there on click of a button open a new address bar disabled window to redirect to the app&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Glossary:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.squarefree.com/securitytips/web-developers.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.squarefree.com/securitytips/web-developers.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://artandlogic.com/2013/05/ive-been-doing-it-wrong-part-1-of-3/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://artandlogic.com/2013/05/ive-been-doing-it-wrong-part-1-of-3/&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://code.tutsplus.com/tutorials/important-considerations-when-building-single-page-web-apps--net-29356&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://code.tutsplus.com/tutorials/important-considerations-when-building-single-page-web-apps--net-29356&lt;/a&gt; &lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;An AngularJS web app finally results in a Single Page Web Application, managing it’s own routes, states (models), incorporating workflows, CRUD operations and much more around some tasks. So, primarily we have to concentrate on the common flaws found in an web app and then figure out what kind of direct or derived vulnerability may be caused in our app. &lt;/p&gt;
    
    </summary>
    
      <category term="Best Practices" scheme="http://coderuse.com/categories/Best-Practices/"/>
    
      <category term="Web App" scheme="http://coderuse.com/categories/Best-Practices/Web-App/"/>
    
      <category term="AngularJS" scheme="http://coderuse.com/categories/Best-Practices/Web-App/AngularJS/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/Best-Practices/Web-App/AngularJS/Technical/"/>
    
    
      <category term="angularjs" scheme="http://coderuse.com/tags/angularjs/"/>
    
      <category term="best-practices" scheme="http://coderuse.com/tags/best-practices/"/>
    
      <category term="web-app" scheme="http://coderuse.com/tags/web-app/"/>
    
  </entry>
  
  <entry>
    <title>Install Deluge on Ubuntu Server</title>
    <link href="http://coderuse.com/2015/12/install-deluge/"/>
    <id>http://coderuse.com/2015/12/install-deluge/</id>
    <published>2015-12-13T08:05:37.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Deluge is a very efficient torrent download/seeding client with a moderately good standard web ui. Though torrent is not acceptable to some extent on the moral ground, I can accept it to download software, songs, movies etc. for small personal uses. Actually why not. I live in India. Most of the Hollywood movies does not release in the theaters. The price of a Western music label is more than per capita income in this country. And I’m not going to sell or do some kind of business with the downloaded digital assets. And most of the movies are not that good to view multiple times. So download-watch-delete cycle is destined for them. With these logic I can justify my use of torrents.&lt;/p&gt;
&lt;p&gt;There are several clients to use torrent. Why do we need one client with web ui. To remotely administer the download. Why? Personally I don’t like to keep my pc turned on whole night-n-day to download large files. And sometimes it really takes a painfully long time to download. Therefore we need to have a low cost solution for this task. You can setup one Raspberry PI in your home for this. Or you can buy one cheap VPS or if you are damn serious about seeding you can get one dedicated server with a good bandwidth allocation from a p2p allowing provider. In any of this cases you need one sufficiently robust torrent client with an acceptable ui. Deluge is one of the best in this category.&lt;/p&gt;
&lt;p&gt;Let’s start. &lt;a id=&quot;more&quot;&gt;&lt;/a&gt; To start this thing, we have to understand that the world of torrent is really full of very troublesome torrents. Before leaving our server to download our favorite entertainment, we must secure our server to some extent with some defensive measures. [I’ll try to add a different post for this purpose]&lt;/p&gt;
&lt;p&gt;One thing is that, to execute this whole procedure, one need to have at-least system administrator privilege for the login. First log into the system. If the login is for normal user, execute the command &lt;span class=&quot;lang:sh decode:true crayon-inline &quot;&gt;sudo -i&lt;/span&gt;  and when prompted give your login password.&lt;/p&gt;
&lt;p&gt;To run the Deluge server on our box, we will need one different user, than the users, we use to login into our system. For example we are using ‘&lt;em&gt;deluge&lt;/em&gt;‘ as the name for both of our user and group.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;adduser --disabled-password --system --home /var/lib/deluge --gecos &lt;span class=&quot;string&quot;&gt;&quot;Deluge Server&quot;&lt;/span&gt; --group deluge&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--disabled-password&lt;/code&gt;  disables the login with password, however login can be done by other means, for example by SSH RSA keys (though we don’t require this feature)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--system&lt;/code&gt;  specifies that both user and group will be one SYSTEM user and group&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--home&lt;/code&gt;  specifies ‘&lt;em&gt;/var/lib/deluge&lt;/em&gt;‘ as the home directory of the newly created user (for us it’s ‘&lt;em&gt;deluge&lt;/em&gt;‘). One more thing is that, by default &lt;em&gt;Deluge&lt;/em&gt; will be installed in this location&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--gecos&lt;/code&gt;  Specifies META data, to be inserted into the ‘&lt;em&gt;/etc/passwd&lt;/em&gt;‘ about the user. Typically this information may be phone number, name of the user etc. We can put any information after this in double quote&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--group&lt;/code&gt;  this option combined with ‘&lt;em&gt;–system&lt;/em&gt;‘, creates user and group with same name specified after this (for now, it’s ‘&lt;em&gt;deluge&lt;/em&gt;‘)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To run &lt;em&gt;Deluge&lt;/em&gt;, we need to run &lt;em&gt;Deluge Server&lt;/em&gt; and &lt;em&gt;Deluge Web&lt;/em&gt;. The &lt;em&gt;web&lt;/em&gt; component is the interface for the user to interact with the &lt;em&gt;Deluge Server&lt;/em&gt;. Now we need to create &lt;em&gt;two&lt;/em&gt; files to be logged by two components. We can do that by:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;touch /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/deluged.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;touch /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/deluge-web.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chown deluge:deluge /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/deluge*&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;touch&lt;/code&gt;  is a &lt;em&gt;*nix&lt;/em&gt; utility to change the time-stamp of a file and if the file does not exist, it creates one empty file with the name and location specified&lt;/li&gt;
&lt;li&gt;&lt;code&gt;chown&lt;/code&gt;  adds the ownership to the user and group specified. Here we have given permission/ownership of ‘&lt;em&gt;/var/log&lt;/em&gt;‘ to user &lt;em&gt;deluge&lt;/em&gt; of group &lt;em&gt;deluge&lt;/em&gt; to write logs into the said directory&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We have to add the &lt;em&gt;Deluge&lt;/em&gt; ‘&lt;em&gt;ppa&lt;/em&gt;‘ repository to get the latest package published for your &lt;em&gt;Ubuntu&lt;/em&gt; distribution.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apt-get install software-properties-common&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;add-apt-repository ppa:deluge-team/ppa&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt-get update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;software-properties-common&lt;/code&gt;  gives the ‘&lt;em&gt;add-apt-repository&lt;/em&gt;‘ command&lt;/li&gt;
&lt;li&gt;&lt;code&gt;apt-get update&lt;/code&gt;  updates our &lt;em&gt;apt&lt;/em&gt; cache for installation and update of software packages in the box&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we are ready to install the &lt;em&gt;Deluge&lt;/em&gt; packages.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apt-get install deluged deluge-webui&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;deluged&lt;/code&gt;  is the &lt;em&gt;Deluge&lt;/em&gt; server and&lt;/li&gt;
&lt;li&gt;&lt;code&gt;deluge-webui&lt;/code&gt;  is the web interface of &lt;em&gt;Deluge&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To start &lt;em&gt;Deluge&lt;/em&gt; server and &lt;em&gt;Deluge WebUI&lt;/em&gt; at the start, we need to create two files in the &lt;code&gt;/etc/init&lt;/code&gt;  directory. Use your favorite editor to create the &lt;em&gt;init&lt;/em&gt; script for &lt;em&gt;Deluge&lt;/em&gt; daemon (server) &lt;code&gt;/etc/init/deluged.conf&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;description &lt;span class=&quot;string&quot;&gt;&quot;Deluge daemon&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;author &lt;span class=&quot;string&quot;&gt;&quot;Deluge Team&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;start on filesystem and static-network-up&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;stop on runlevel [&lt;span class=&quot;number&quot;&gt;016&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;respawn&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;respawn &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env uid=deluge&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env gid=deluge&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env &lt;span class=&quot;built_in&quot;&gt;umask&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; start-stop-daemon -S -c &lt;span class=&quot;variable&quot;&gt;$uid&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;$gid&lt;/span&gt; -k &lt;span class=&quot;variable&quot;&gt;$umask&lt;/span&gt; -x /usr/bin/deluged -- &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;and for &lt;em&gt;Deluge WebUI&lt;/em&gt; &lt;code&gt;/etc/init/deluge-web.conf&lt;/code&gt; .&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;description &lt;span class=&quot;string&quot;&gt;&quot;Deluge Web UI&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;author &lt;span class=&quot;string&quot;&gt;&quot;Deluge Team&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;start on started deluged&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;stop on stopping deluged&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;respawn&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;respawn &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env uid=deluge&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env gid=deluge&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env &lt;span class=&quot;built_in&quot;&gt;umask&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;027&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; start-stop-daemon -S -c &lt;span class=&quot;variable&quot;&gt;$uid&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;$gid&lt;/span&gt; -k &lt;span class=&quot;variable&quot;&gt;$umask&lt;/span&gt; -x /usr/bin/deluge-web&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;There are more details about this configurations &lt;a href=&quot;http://dev.deluge-torrent.org/wiki/UserGuide/Service/Upstart&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now we can reboot our server by &lt;code&gt;init 6&lt;/code&gt;  or &lt;code&gt;reboot -h now&lt;/code&gt;  or start the &lt;em&gt;Deluge&lt;/em&gt; services by&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service deluged start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;service deluge-web start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Access the web interface at port &lt;em&gt;8112&lt;/em&gt;. &lt;code&gt;http://yourserver_IP_OR_domain:8112&lt;/code&gt; . It will prompt for a password. Type ‘&lt;em&gt;deluge&lt;/em&gt;‘ and login. This is the default password for the WebUI. And we must change our password upon first login.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/RbZcl4F.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Also it may be required to connect the &lt;em&gt;daemon&lt;/em&gt; by clicking the ‘&lt;em&gt;Connection Manager&lt;/em&gt;‘ button at the top task-bar.&lt;/p&gt;
&lt;p&gt;This is not complete. Yet we have to do a little configuration for the &lt;em&gt;Deluge Daemon&lt;/em&gt; and mask our web port with a good context name on our server. We will use NginX for this. And along with that we will add a new security measure. But this is pending for next post. Until then have a good time. :)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Deluge is a very efficient torrent download/seeding client with a moderately good standard web ui. Though torrent is not acceptable to some extent on the moral ground, I can accept it to download software, songs, movies etc. for small personal uses. Actually why not. I live in India. Most of the Hollywood movies does not release in the theaters. The price of a Western music label is more than per capita income in this country. And I’m not going to sell or do some kind of business with the downloaded digital assets. And most of the movies are not that good to view multiple times. So download-watch-delete cycle is destined for them. With these logic I can justify my use of torrents.&lt;/p&gt;
&lt;p&gt;There are several clients to use torrent. Why do we need one client with web ui. To remotely administer the download. Why? Personally I don’t like to keep my pc turned on whole night-n-day to download large files. And sometimes it really takes a painfully long time to download. Therefore we need to have a low cost solution for this task. You can setup one Raspberry PI in your home for this. Or you can buy one cheap VPS or if you are damn serious about seeding you can get one dedicated server with a good bandwidth allocation from a p2p allowing provider. In any of this cases you need one sufficiently robust torrent client with an acceptable ui. Deluge is one of the best in this category.&lt;/p&gt;
&lt;p&gt;Let’s start.
    
    </summary>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/Cookbook/"/>
    
      <category term="System" scheme="http://coderuse.com/categories/Cookbook/System/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/Cookbook/System/Technical/"/>
    
    
      <category term="deluge" scheme="http://coderuse.com/tags/deluge/"/>
    
      <category term="torrent" scheme="http://coderuse.com/tags/torrent/"/>
    
      <category term="ubuntu" scheme="http://coderuse.com/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Create new tab/window from JavaScript</title>
    <link href="http://coderuse.com/2015/12/create-new-tabwindow-from-javascript/"/>
    <id>http://coderuse.com/2015/12/create-new-tabwindow-from-javascript/</id>
    <published>2015-12-04T03:15:43.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;Yesterday I was stuck in a very strange situation. It was required to open a tab from a success handler of a server call. Actually browser lets open a new tab/window from JavaScript if the ‘opening code’ is directly inside of a user event handler. May be a click, may be blur event or focus event, even page load. Otherwise it understands that the client side code is trying to open a new tab/window unauthorized; and the in-built popup blocker blocks the opening of the same; one browser specific indication of-course shown that a popup has been blocked.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;After a little search I came across one solution to make the server call synchronous, then the new tab/window ‘opening code’ would be directly in the user event and there will be no problem in the intended purpose.&lt;/p&gt;
&lt;p&gt;Keeping the above consideration in mind, came with one more solution, one solution that can by-pass the situation.&lt;/p&gt;
&lt;p&gt;Solution 1:&lt;/p&gt;
&lt;p&gt;Make the server call synchronous, so that the new tab/window opening code be directly in the user event handler. (&lt;a href=&quot;http://plnkr.co/edit/PK4XDhyYaaU7BLOrAssV?p=preview&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;plunker&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Solution 2:&lt;/p&gt;
&lt;p&gt;Create one window, in the same closure, as the server call is made and keep the reference to it in a variable. And in the success handler of the call, change the location of the window created in-prior or close the same in error handler. (Closing the window may be a problem for Chrome &amp;amp; Firefox) (&lt;a href=&quot;http://plnkr.co/edit/hbqrmok6Hd7YzOoidRPP?p=preview&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;plunker&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Solution 3:&lt;/p&gt;
&lt;p&gt;In the success handler create one confirmation dialog for the user, and in the ‘OK’ handler create the intended new tab/window.&lt;/p&gt;
&lt;p&gt;There may be another solution to create a form with &lt;span class=&quot;lang:xhtml decode:true crayon-inline &quot;&gt;target=”_blank”&lt;/span&gt; and in the action we will do the intended server call. But, I’ve not tried it. And this may not be a very good approach.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Yesterday I was stuck in a very strange situation. It was required to open a tab from a success handler of a server call. Actually browser lets open a new tab/window from JavaScript if the ‘opening code’ is directly inside of a user event handler. May be a click, may be blur event or focus event, even page load. Otherwise it understands that the client side code is trying to open a new tab/window unauthorized; and the in-built popup blocker blocks the opening of the same; one browser specific indication of-course shown that a popup has been blocked.&lt;/p&gt;
    
    </summary>
    
      <category term="Browser" scheme="http://coderuse.com/categories/Browser/"/>
    
      <category term="Cookbook" scheme="http://coderuse.com/categories/Browser/Cookbook/"/>
    
      <category term="JavaScript" scheme="http://coderuse.com/categories/Browser/Cookbook/JavaScript/"/>
    
      <category term="Technical" scheme="http://coderuse.com/categories/Browser/Cookbook/JavaScript/Technical/"/>
    
    
      <category term="browser" scheme="http://coderuse.com/tags/browser/"/>
    
      <category term="chrome" scheme="http://coderuse.com/tags/chrome/"/>
    
      <category term="create-new-tab" scheme="http://coderuse.com/tags/create-new-tab/"/>
    
      <category term="firefox" scheme="http://coderuse.com/tags/firefox/"/>
    
      <category term="ie" scheme="http://coderuse.com/tags/ie/"/>
    
      <category term="internet-explorer" scheme="http://coderuse.com/tags/internet-explorer/"/>
    
      <category term="javascript" scheme="http://coderuse.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>Hello world!</title>
    <link href="http://coderuse.com/2015/11/hello-world/"/>
    <id>http://coderuse.com/2015/11/hello-world/</id>
    <published>2015-11-28T07:51:50.000Z</published>
    <updated>2020-02-23T16:26:38.956Z</updated>
    
    <content type="html">&lt;p&gt;After thinking a lot and checking the amount of free time I get, finally decided to start a blog. I know after a short period of time eventually I would get bored and just stop to update this site. There is a risk of this to happen. But at-least let’s just start it. Later, we will see. There must be something, I can say, I’ve done this. After working for a long time in service sector, I think this is a common trait built in every software engineers to do something, that s/he can take credit of.&lt;/p&gt;
&lt;p&gt;Actually what we do, the solutions can be searched and surprisingly people have already come across the same problem one to three years back. StackOverflow is practically “Overflowing” with suitable answers to all of our questions. So there is no need to think over anything. And even if we get a real problem to solve (apparently the solution of which could not be found by Google search), managers understands that and discusses with client with such a rigor and extensiveness, that eventually the poor creature modifies the requirement and the problem gets “SOLVED”.&lt;/p&gt;
&lt;p&gt;With having no friend and attachments outside of the office, this blog will ultimately turn into a common “TECHNOLOGY BLOG”. I know. But, I’ll try to write fascinating ideas, conceptions to me.&lt;/p&gt;
&lt;p&gt;And of-course let’s hope that, I do not lose interest to update this. :-)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;After thinking a lot and checking the amount of free time I get, finally decided to start a blog. I know after a short period of time eve
    
    </summary>
    
      <category term="Personal" scheme="http://coderuse.com/categories/Personal/"/>
    
      <category term="Sattire" scheme="http://coderuse.com/categories/Personal/Sattire/"/>
    
    
      <category term="daily-routine" scheme="http://coderuse.com/tags/daily-routine/"/>
    
      <category term="office" scheme="http://coderuse.com/tags/office/"/>
    
      <category term="view-towards-life" scheme="http://coderuse.com/tags/view-towards-life/"/>
    
  </entry>
  
</feed>
