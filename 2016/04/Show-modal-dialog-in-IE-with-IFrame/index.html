<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@coderuse"><meta name="twitter:title" content="Show modal dialog in IE with IFrame"><meta name="twitter:description" content="&lt;p&gt;We had used modal dialog of IE, in one of our old projects. What we did there, opened one modal dialog, with one url to a external website. In the external page (not maintained by us), one variable &lt;code&gt;returnValue&lt;/code&gt; was set to &lt;code&gt;window&lt;/code&gt; with the intended value (one object actually), and we used to get the resultant from the return value of &lt;code&gt;showModalDialog&lt;/code&gt;, as this returns the value present in &lt;code&gt;window.returnValue&lt;/code&gt; of the modal.&lt;/p&gt;"><meta name="twitter:image" content="http://i.imgur.com/9RX3TO3.png"><title>Show modal dialog in IE with IFrame | CodeRuse</title><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300|Roboto:300|Inconsolata"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="amphtml" href="./amp/index.html"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">CodeRuse</a><!--span.subtitle= config.subtitle--><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><div id="top-nav" class="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" target="_blank" class="sidebar-nav-item">Archives</a><a href="http://galleries.coderuse.com" target="_blank" class="sidebar-nav-item">Galleries</a><a href="/about" target="_blank" class="sidebar-nav-item">About</a></div></div><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>Show modal dialog in IE with IFrame</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">Apr 27, 2016</div><div class="post-categories"><a class="post-category-link" href="/categories/JavaScript/">JavaScript</a>><a class="post-category-link" href="/categories/JavaScript/IE/">IE</a>><a class="post-category-link" href="/categories/JavaScript/IE/IFrame/">IFrame</a>><a class="post-category-link" href="/categories/JavaScript/IE/IFrame/Interesting/">Interesting</a>><a class="post-category-link" href="/categories/JavaScript/IE/IFrame/Interesting/Cookbook/">Cookbook</a></div><div class="post-tags"><a class="post-tag-link" href="/tags/IE/">IE</a>/<a class="post-tag-link" href="/tags/IFrame/">IFrame</a>/<a class="post-tag-link" href="/tags/javascript/">javascript</a>/<a class="post-tag-link" href="/tags/modal/">modal</a>/<a class="post-tag-link" href="/tags/returnValue/">returnValue</a></div></div></div><article><div class="container post"><p>We had used modal dialog of IE, in one of our old projects. What we did there, opened one modal dialog, with one url to a external website. In the external page (not maintained by us), one variable <code>returnValue</code> was set to <code>window</code> with the intended value (one object actually), and we used to get the resultant from the return value of <code>showModalDialog</code>, as this returns the value present in <code>window.returnValue</code> of the modal.</p>
<a id="more"></a>
<p>Here is the bare minimum code of the markup creating the modal.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">title</span>&gt;</span>Show Modal Test<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">id</span>=<span class="value">"name"</span> <span class="attribute">disabled</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">id</span>=<span class="value">"button1"</span> <span class="attribute">onclick</span>=<span class="value">"openWindows()"</span> <span class="attribute">value</span>=<span class="value">"Enter Name"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">openWindows</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Get the return value set by the modal window</span></span><br><span class="line">      <span class="keyword">var</span> getval = <span class="built_in">window</span>.showModalDialog(<span class="string">'modal.html'</span>);</span><br><span class="line">      <span class="built_in">window</span>.document.getElementById(<span class="string">'name'</span>).value = getval.data;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>And this is the markup of the modal (maintained by third party). The <code>returnValue</code> property in the <code>window</code> object of <code>modal</code>, is returned by the <code>showModalDialog</code> method.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- modal.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">title</span>&gt;</span>Modal Window<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">id</span>=<span class="value">"inputName"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">id</span>=<span class="value">"btnReturnValues"</span> <span class="attribute">onclick</span>=<span class="value">"ReturnValues()"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ReturnValues</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> vReturnValue = <span class="built_in">document</span>.getElementById(<span class="string">'inputName'</span>).value;</span><br><span class="line">      <span class="built_in">window</span>.returnValue = &#123;</span><br><span class="line">          data: vReturnValue</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">window</span>.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>After some time, due to some sizing issue of the modal dialog, we used one intermediary HTML page as the content of the modal. And, in that page we navigated to the external link, via an IFrame, setting the dimention. So, we added the url of the container (where the IFrame resides) as the first parameter of the method <code>showModalDialog</code> and sending the url of the intended url as <code>dialogArguments</code> (<a href="https://goo.gl/a3lcwG" target="_blank" rel="external">refer to</a>).</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> getval = w.showModalDialog(<span class="string">'container.html'</span>, <span class="string">'modal.html'</span>, <span class="string">'dialogWidth:960px; dialogHeight: 670px; resizable: yes'</span>);</span><br></pre></td></tr></table></figure>
<p>And added the container page. Modifications were not required in the third party page.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- container.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">title</span>&gt;</span>Conatiner<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">iframe</span> <span class="attribute">onload</span>=<span class="value">"setStyle()"</span> <span class="attribute">name</span>=<span class="value">"iframeExternalLink"</span> <span class="attribute">id</span>=<span class="value">"iframeExternalLink"</span>&gt;</span><span class="tag">&lt;/<span class="title">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> url = <span class="built_in">window</span>.dialogArguments;</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">'iframeExternalLink'</span>).src = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly setting the height of the IFrame. Even if the third-party page comes bogger, scroll bars will come</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStyle</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">'iframeExternalLink'</span>).height = <span class="string">'670px'</span>;</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">'iframeExternalLink'</span>).width = <span class="string">'960px'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>That was working fine, till last week. After one patch (Current version: IE11-11.0.9600.18204, IE10-10.0.9200.17640), the procedure is not working as previous. If we examine closely, this should not work previously also. As from the external web page, the <code>returnValue</code> property is set in the <code>window</code>, that property is set theoretically to the <code>window</code> object of the IFrame itself. But somehow it was working.</p>
<p>As we are opening third party url, it’s a long procedure, to tell them to change in their code. So, we were searching for a solution, so that, third party code should not needed to be affected.</p>
<p>After some brainstorming, we thought that, in the <code>onbeforeunload</code> event (called before closing of a window), in the <code>container.html</code>, we can set the <code>returnValue</code> property in the <code>window</code> object of the page, where the IFrame resides.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onbeforeunload = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> win = <span class="built_in">window</span>.frames[<span class="string">'iframeExternalLink'</span>];</span><br><span class="line">  <span class="built_in">window</span>.returnValue = win.returnValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This was working. But, that again didn’t work. As, the third party website is using Telerik, the library sets the <code>onbeforeunload</code> as it requires. So, our event handler is at all not fired.</p>
<p>What to do now?</p>
<p>We found our second approach. But this approach requires modification in the third party code. In the function, where the <code>window.close</code> is called, they need to call one method <code>setReturnValue</code> of <code>parent</code>, which in turn will set the <code>returnValue</code> in the parent (the modal window) or directly set the value of the property <code>returnValue</code> in <code>window.parent</code>.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!-- In container.html --&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setReturnValue</span> (<span class="params">returnVal</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.returnValue = returnVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>and in the external web page: </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// In modal.html</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ReturnValues</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> vReturnValue = <span class="built_in">document</span>.getElementById(<span class="string">'inputName'</span>).value;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Call the method in parent to set the returnValue</span></span><br><span class="line">  <span class="built_in">window</span>.parent.setReturnValue( &#123;</span><br><span class="line">    data: vReturnValue</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">window</span>.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>or in short,</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// In modal.html</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.parent.returnValue = &#123;</span><br><span class="line">  data: vReturnValue</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>This would solve the problem. Easy solution. Right?</p>
</div><!-- comment system--><div class="container"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'coderuse';
var disqus_identifier = '2016/04/Show-modal-dialog-in-IE-with-IFrame/';
var disqus_title = "Show modal dialog in IE with IFrame";
var disqus_url = 'http://coderuse.com/2016/04/Show-modal-dialog-in-IE-with-IFrame/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><div id="footer"><div class="container"><div class="bar"><div class="social"><a href="http://twitter.com/coderuse" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/coderuse" target="_blank"><i class="fa fa-github"></i></a><a href="https://plus.google.com/+ArnabDasUIDeveloper" target="_blank"><i class="fa fa-google-plus"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© <a href="/" rel="nofollow">CodeRuse</a> | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0</a></div></div></div></div><script>var trackID = 'UA-70816071-1', domainID = 'coderuse.com';(function (i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r] || function(){(i[r].q=i[r].q || []).push(arguments);},i[r].l = 1 * new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.defer=1;a.src=g;m.parentNode.insertBefore(a,m)})(window, document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', trackID, domainID);ga('send', 'pageview');</script></body></html>